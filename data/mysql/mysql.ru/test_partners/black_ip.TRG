TYPE=TRIGGERS
triggers='CREATE DEFINER=`root`@`localhost` TRIGGER `black_ip_insert_check` AFTER INSERT ON `black_ip`\n FOR EACH ROW BEGIN\n\nIF @auth_login IS null THEN\n    INSERT INTO `test_partners_changes`.`null_who_change`(id, `who_change`) VALUES(null, @auth_login);\nEND IF;\n\n\nINSERT INTO `test_partners_changes`.`black_ip_changes`(`ip`, `field`, `old_value`, `new_value`, `when`, `who`, `mysql_user`)\n    VALUES(NEW.ip, \'ip\', \'\', NEW.ip, NOW(), @auth_login, USER());\n\nINSERT INTO `test_partners_changes`.`black_ip_changes`(`ip`, `field`, `old_value`, `new_value`, `when`, `who`, `mysql_user`)\n    VALUES(NEW.ip, \'comment\', \'\', NEW.comment, NOW(), @auth_login, USER());\n\nINSERT INTO `test_partners_changes`.`black_ip_changes`(`ip`, `field`, `old_value`, `new_value`, `when`, `who`, `mysql_user`)\n    VALUES(NEW.ip, \'add_type\', \'\', NEW.add_type, NOW(), @auth_login, USER());\n\nINSERT INTO `test_partners_changes`.`black_ip_changes`(`ip`, `field`, `old_value`, `new_value`, `when`, `who`, `mysql_user`)\n    VALUES(NEW.ip, \'without_referer\', \'\', NEW.without_referer, NOW(), @auth_login, USER());\n\nINSERT INTO `test_partners_changes`.`black_ip_changes`(`ip`, `field`, `old_value`, `new_value`, `when`, `who`, `mysql_user`)\n    VALUES(NEW.ip, \'moderate_status\', \'\', NEW.moderate_status, NOW(), @auth_login, USER());\n\n\nEND' 'CREATE DEFINER=`root`@`localhost` TRIGGER `test_partners`.`black_ip_changes` AFTER UPDATE ON `test_partners`.`black_ip`\n FOR EACH ROW BEGIN\n\nIF (OLD.ip != NEW.ip) THEN\n  INSERT INTO `test_partners_changes`.`black_ip_changes`(`ip`, `field`, `old_value`, `new_value`, `when`, `who`, `mysql_user`)\n    VALUES(NEW.ip, \'ip\', OLD.ip, NEW.ip, NOW(), @auth_login, USER());\nEND IF;\n\nIF (OLD.add_type != NEW.add_type) THEN\n  INSERT INTO `test_partners_changes`.`black_ip_changes`(`ip`, `field`, `old_value`, `new_value`, `when`, `who`, `mysql_user`)\n    VALUES(NEW.ip, \'add_type\', OLD.add_type, NEW.add_type, NOW(), @auth_login, USER());\nEND IF;\n\nIF (OLD.without_referer != NEW.without_referer) THEN\n  INSERT INTO `test_partners_changes`.`black_ip_changes`(`ip`, `field`, `old_value`, `new_value`, `when`, `who`, `mysql_user`)\n    VALUES(NEW.ip, \'without_referer\', OLD.without_referer, NEW.without_referer, NOW(), @auth_login, USER());\nEND IF;\n\nIF (OLD.moderate_status != NEW.moderate_status) THEN\n  INSERT INTO `test_partners_changes`.`black_ip_changes`(`ip`, `field`, `old_value`, `new_value`, `when`, `who`, `mysql_user`)\n    VALUES(NEW.ip, \'moderate_status\', OLD.moderate_status, NEW.moderate_status, NOW(), @auth_login, USER());\nEND IF;\n\n\nEND' 'CREATE DEFINER=`root`@`localhost` TRIGGER `black_ip_delete_check` BEFORE DELETE ON `black_ip`\n FOR EACH ROW BEGIN\n\nIF @auth_login IS null THEN\n    INSERT INTO `test_partners_changes`.`null_who_change`(id, `who_change`) VALUES(null, @auth_login);\nEND IF;\n\n\nINSERT INTO `test_partners_changes`.`black_ip_changes`(`ip`, `field`, `old_value`, `new_value`, `when`, `who`, `mysql_user`)\n    VALUES(OLD.ip, \'delete\', \'\', \'\', NOW(), @auth_login, USER());\n\nEND'
sql_modes=1342177280 1342177280 1342177280
definers='root@localhost' 'root@localhost' 'root@localhost'
client_cs_names='utf8' 'utf8' 'utf8'
connection_cl_names='utf8_general_ci' 'utf8_general_ci' 'utf8_general_ci'
db_cl_names='utf8_general_ci' 'utf8_general_ci' 'utf8_general_ci'
created=153375877554 153375877555 153375877556
