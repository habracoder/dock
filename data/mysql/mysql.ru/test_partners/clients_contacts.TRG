TYPE=TRIGGERS
triggers='CREATE DEFINER=`root`@`localhost` TRIGGER `test_partners`.`clients_contacts_changes` AFTER UPDATE ON `test_partners`.`clients_contacts`\nFOR EACH ROW BEGIN\n\nIF (OLD.email != NEW.email) THEN\n    INSERT INTO `test_partners_changes`.`clients_contacts_changes`(`id`, `clients_contacts_id`, `field`, `old_value`, `new_value`, `when`, `who`, `mysql_user`)\n            VALUES(NULL , NEW.id, \'email\', OLD.email, NEW.email, NOW(), @auth_login, USER());\nEND IF;\n\nIF (OLD.additional_email != NEW.additional_email) THEN\n    INSERT INTO `test_partners_changes`.`clients_contacts_changes`(`id`, `clients_contacts_id`, `field`, `old_value`, `new_value`, `when`, `who`, `mysql_user`)\n            VALUES(NULL , NEW.id, \'additional_email\', OLD.additional_email, NEW.additional_email, NOW(), @auth_login, USER());\nEND IF;\n\nIF (OLD.`name` != NEW.`name`) THEN\n    INSERT INTO `test_partners_changes`.`clients_contacts_changes`(`id`, `clients_contacts_id`, `field`, `old_value`, `new_value`, `when`, `who`, `mysql_user`)\n            VALUES(NULL , NEW.id, \'name\', OLD.`name`, NEW.`name`, NOW(), @auth_login, USER());\nEND IF;\n\nIF (OLD.icq != NEW.icq) THEN\n    INSERT INTO `test_partners_changes`.`clients_contacts_changes`(`id`, `clients_contacts_id`, `field`, `old_value`, `new_value`, `when`, `who`, `mysql_user`)\n            VALUES(NULL , NEW.id, \'icq\', OLD.icq, NEW.icq, NOW(), @auth_login, USER());\nEND IF;\n\nIF (OLD.skype != NEW.skype) THEN\n    INSERT INTO `test_partners_changes`.`clients_contacts_changes`(`id`, `clients_contacts_id`, `field`, `old_value`, `new_value`, `when`, `who`, `mysql_user`)\n            VALUES(NULL , NEW.id, \'skype\', OLD.skype, NEW.skype, NOW(), @auth_login, USER());\nEND IF;\n\nIF (NOT OLD.phone <=> NEW.phone) THEN\n    INSERT INTO `test_partners_changes`.`clients_contacts_changes`(`id`, `clients_contacts_id`, `field`, `old_value`, `new_value`, `when`, `who`, `mysql_user`)\n            VALUES(NULL , NEW.id, \'phone\', IF(OLD.phone IS NOT NULL, OLD.phone, \'\'), IF(NEW.phone IS NOT NULL, NEW.phone, \'\'), NOW(), @auth_login, USER());\nEND IF;\n\nIF (OLD.comments != NEW.comments) THEN\n    INSERT INTO `test_partners_changes`.`clients_contacts_changes`(`id`, `clients_contacts_id`, `field`, `old_value`, `new_value`, `when`, `who`, `mysql_user`)\n            VALUES(NULL , NEW.id, \'comments\', OLD.comments, NEW.comments, NOW(), @auth_login, USER());\nEND IF;\n\nEND'
sql_modes=1342177280
definers='root@localhost'
client_cs_names='utf8'
connection_cl_names='utf8_general_ci'
db_cl_names='utf8_general_ci'
created=153375877581
