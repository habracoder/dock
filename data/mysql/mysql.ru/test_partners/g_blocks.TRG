TYPE=TRIGGERS
triggers='CREATE DEFINER=`root`@`localhost` TRIGGER `test_partners`.`g_blocks_insert_before` BEFORE INSERT ON `g_blocks`\n FOR EACH ROW BEGIN\n    IF (NEW.subnet = 2) THEN\n\n		SET NEW.only_selected_cat = 1;\n\n        IF (NEW.lng_id = 1) THEN\n            SET NEW.mirror = "tovarro";\n        ELSEIF (NEW.lng_id = 7) THEN\n            SET NEW.mirror = "adskeeper";\n        END IF;\n\n    ELSEIF (NEW.mirror = "tovarro") THEN\n        SET NEW.subnet = 2;\n    ELSEIF (NEW.mirror = "adskeeper") THEN\n        SET NEW.subnet = 2;\n    END IF;\n    IF (NEW.xml = 1) THEN\n        SET NEW.no_calc_ghits_ctr = 1;\n	END IF;\n	IF (NEW.no_calc_ghits_ctr = 1) THEN\n		SET NEW.without_green_ghits = 1;\n	END IF;\n	IF NEW.`count_news` > 120 THEN\n		SET NEW.`count_news` = 120;\n	END IF;\n\n	IF NEW.`category_platform` = 103 AND NEW.lng_id = 7 THEN\n		SET NEW.`counters_disabled` = 1;\n	END IF;\n\n	IF NEW.`tickers_composite_id` IS NOT NULL THEN\n		SET NEW.`class` = \'composite\';\n		SET NEW.`parent` = NEW.`tickers_composite_id`;\n	END IF;\n\n	IF NEW.`tickers_under_id` IS NOT NULL THEN\n		SET NEW.`class` = \'under\';\n		SET NEW.`parent` = NEW.`tickers_under_id`;\n	END IF;\n\n	IF NEW.`class` = \'composite\' AND NEW.`tickers_composite_id` IS NULL THEN\n		SET NEW.`tickers_composite_id` = NEW.`parent`;\n	END IF;\n\n	IF NEW.`class` = \'under\' AND NEW.`tickers_under_id` IS NULL THEN\n		SET NEW.`tickers_under_id` = NEW.`parent`;\n	END IF;\n\n	IF NEW.`tickers_composite_id` IS NOT NULL AND NEW.`tickers_under_id` IS NOT NULL THEN\n		SIGNAL SQLSTATE \'45000\' SET MESSAGE_TEXT = "Widget can\'t have composite id and under id filled simultaneously";\n	END IF;\n\nEND' 'CREATE DEFINER=`root`@`localhost` TRIGGER `g_blocks_insert_after` AFTER INSERT ON `g_blocks`\n FOR EACH ROW BEGIN \n\nCALL insert_g_blocks(NEW.id, NEW.count_news); \n\nEND' 'CREATE DEFINER=`root`@`localhost` TRIGGER `test_partners`.`g_blocks_changes_before` BEFORE UPDATE ON `g_blocks`\nFOR EACH ROW BEGIN\n\nIF (OLD.subnet != NEW.subnet) THEN\n    IF (NEW.subnet = 0) THEN\n        SET NEW.mirror = "marketgid";\n    ELSEIF (NEW.subnet = 2) THEN\n        IF (NEW.lng_id = 1) THEN\n            SET NEW.mirror = "tovarro";\n        ELSEIF (NEW.lng_id = 7) THEN\n            SET NEW.mirror = "adskeeper";\n        END IF;\n    END IF;\nELSEIF (OLD.mirror != NEW.mirror) THEN\n    IF (NEW.mirror = "marketgid") THEN\n        SET NEW.subnet = 0;\n    ELSEIF (NEW.mirror = "tovarro") THEN\n        SET NEW.subnet = 2;\n    ELSEIF (NEW.mirror = "adskeeper") THEN\n        SET NEW.subnet = 2;\n    END IF;\nEND IF;\n\nIF (OLD.xml != NEW.xml) THEN\n	IF (NEW.xml = 1) THEN\n		SET NEW.no_calc_ghits_ctr = 1;\n	ELSE \n		SET NEW.no_calc_ghits_ctr = 0;\n    END IF;\nEND IF;\n\nIF (OLD.no_calc_ghits_ctr != NEW.no_calc_ghits_ctr) THEN\n	IF (NEW.no_calc_ghits_ctr = 1) THEN\n		SET NEW.without_green_ghits = 1;\n	ELSE \n		SET NEW.without_green_ghits = 0;\n    END IF;\nEND IF;\n\nIF NOT OLD.`is_custom_js` <=> NEW.`is_custom_js` THEN\n    SET NEW.`updated_time` = NOW();\nEND IF;\n\nIF NOT OLD.`custom_js` <=> NEW.`custom_js` THEN\n    SET NEW.`updated_time` = NOW();\nEND IF;\n\nIF OLD.`use_cat` != NEW.`use_cat` THEN\n    SET NEW.`updated_time` = NOW();\nEND IF;\n\nIF OLD.`count_news` != NEW.`count_news` THEN\n    SET NEW.`updated_time` = NOW();\nEND IF;\n\nIF OLD.`filter_2` != NEW.`filter_2` THEN\n    SET NEW.`updated_time` = NOW();\nEND IF;\n\nIF OLD.`use_self` != NEW.`use_self` THEN\n    SET NEW.`updated_time` = NOW();\nEND IF;\n\nIF OLD.`show_source` != NEW.`show_source` THEN\n    SET NEW.`updated_time` = NOW();\nEND IF;\n\nIF OLD.`show_description` != NEW.`show_description` THEN\n    SET NEW.`updated_time` = NOW();\nEND IF;\n\nIF OLD.`photo_only` != NEW.`photo_only` THEN\n    SET NEW.`updated_time` = NOW();\nEND IF;\n\nIF OLD.`time_limit` != NEW.`time_limit` THEN\n    SET NEW.`updated_time` = NOW();\nEND IF;\n\nIF OLD.`big_photo` != NEW.`big_photo` THEN\n    SET NEW.`updated_time` = NOW();\nEND IF;\n\nIF OLD.`animation` != NEW.`animation` THEN\n    SET NEW.`updated_time` = NOW();\nEND IF;\n\nIF OLD.`xml` != NEW.`xml` THEN\n    SET NEW.`updated_time` = NOW();\nEND IF;\n\nIF OLD.`use_tranz_page` != NEW.`use_tranz_page` THEN\n    SET NEW.`updated_time` = NOW();\nEND IF;\n\nIF OLD.`only_selected_cat` != NEW.`only_selected_cat` THEN\n    SET NEW.`updated_time` = NOW();\nEND IF;\n\nIF OLD.`img_type` != NEW.`img_type` THEN\n    SET NEW.`updated_time` = NOW();\nEND IF;\n\nIF OLD.`protocol_version` != NEW.`protocol_version` THEN\n    SET NEW.`updated_time` = NOW();\nEND IF;\n\nIF OLD.`without_green_ghits` != NEW.`without_green_ghits` THEN\n    SET NEW.`updated_time` = NOW();\nEND IF;\n\nIF OLD.`block_duplicate` != NEW.`block_duplicate` THEN\n    SET NEW.`updated_time` = NOW();\nEND IF;\n\nIF OLD.`minimal_prices_of_click_0` != NEW.`minimal_prices_of_click_0` THEN\n    SET NEW.`updated_time` = NOW();\nEND IF;\n\nIF OLD.`minimal_prices_of_click_1` != NEW.`minimal_prices_of_click_1` THEN\n    SET NEW.`updated_time` = NOW();\nEND IF;\n\nIF OLD.`minimal_prices_of_click_2` != NEW.`minimal_prices_of_click_2` THEN\n    SET NEW.`updated_time` = NOW();\nEND IF;\n\nIF OLD.`minimal_prices_of_click_3` != NEW.`minimal_prices_of_click_3` THEN\n    SET NEW.`updated_time` = NOW();\nEND IF;\n\nIF OLD.`minimal_prices_of_click_4` != NEW.`minimal_prices_of_click_4` THEN\n    SET NEW.`updated_time` = NOW();\nEND IF;\n\nIF OLD.`minimal_prices_of_click_5` != NEW.`minimal_prices_of_click_5` THEN\n    SET NEW.`updated_time` = NOW();\nEND IF;\n\nIF OLD.`minimal_prices_of_click_6` != NEW.`minimal_prices_of_click_6` THEN\n    SET NEW.`updated_time` = NOW();\nEND IF;\n\nIF OLD.`minimal_prices_of_click_7` != NEW.`minimal_prices_of_click_7` THEN\n    SET NEW.`updated_time` = NOW();\nEND IF;\n\nIF OLD.`minimal_prices_of_click_8` != NEW.`minimal_prices_of_click_8` THEN\n    SET NEW.`updated_time` = NOW();\nEND IF;\n\nIF OLD.`minimal_prices_of_click_9` != NEW.`minimal_prices_of_click_9` THEN\n    SET NEW.`updated_time` = NOW();\nEND IF;\n\nIF OLD.`minimal_prices_of_click_10` != NEW.`minimal_prices_of_click_10` THEN\n    SET NEW.`updated_time` = NOW();\nEND IF;\n\nIF OLD.`minimal_prices_of_click_11` != NEW.`minimal_prices_of_click_11` THEN\n    SET NEW.`updated_time` = NOW();\nEND IF;\n\nIF OLD.`minimal_prices_of_click_12` != NEW.`minimal_prices_of_click_12` THEN\n    SET NEW.`updated_time` = NOW();\nEND IF;\n\nIF OLD.`minimal_prices_of_click_13` != NEW.`minimal_prices_of_click_13` THEN\n    SET NEW.`updated_time` = NOW();\nEND IF;\n\nIF OLD.`minimal_prices_of_click_14` != NEW.`minimal_prices_of_click_14` THEN\n    SET NEW.`updated_time` = NOW();\nEND IF;\n\nIF OLD.`minimal_prices_of_click_15` != NEW.`minimal_prices_of_click_15` THEN\n    SET NEW.`updated_time` = NOW();\nEND IF;\n\nIF OLD.`minimal_prices_of_click_16` != NEW.`minimal_prices_of_click_16` THEN\n    SET NEW.`updated_time` = NOW();\nEND IF;\n\nIF OLD.`minimal_prices_of_click_17` != NEW.`minimal_prices_of_click_17` THEN\n    SET NEW.`updated_time` = NOW();\nEND IF;\n\nIF OLD.`minimal_prices_of_click_18` != NEW.`minimal_prices_of_click_18` THEN\n    SET NEW.`updated_time` = NOW();\nEND IF;\n\nIF OLD.`minimal_prices_of_click_19` != NEW.`minimal_prices_of_click_19` THEN\n    SET NEW.`updated_time` = NOW();\nEND IF;\n\nIF OLD.`minimal_prices_of_click_20` != NEW.`minimal_prices_of_click_20` THEN\n    SET NEW.`updated_time` = NOW();\nEND IF;\n\nIF OLD.`minimal_prices_of_click_21` != NEW.`minimal_prices_of_click_21` THEN\n    SET NEW.`updated_time` = NOW();\nEND IF;\n\nIF OLD.`minimal_prices_of_click_22` != NEW.`minimal_prices_of_click_22` THEN\n    SET NEW.`updated_time` = NOW();\nEND IF;\n\nIF OLD.`minimal_prices_of_click_23` != NEW.`minimal_prices_of_click_23` THEN\n    SET NEW.`updated_time` = NOW();\nEND IF;\n\nIF OLD.`minimal_prices_of_click_24` != NEW.`minimal_prices_of_click_24` THEN\n    SET NEW.`updated_time` = NOW();\nEND IF;\n\nIF OLD.`minimal_prices_of_click_25` != NEW.`minimal_prices_of_click_25` THEN\n    SET NEW.`updated_time` = NOW();\nEND IF;\n\nIF OLD.`minimal_prices_of_click_26` != NEW.`minimal_prices_of_click_26` THEN\n    SET NEW.`updated_time` = NOW();\nEND IF;\n\nIF OLD.`minimal_prices_of_click_27` != NEW.`minimal_prices_of_click_27` THEN\n    SET NEW.`updated_time` = NOW();\nEND IF;\n\nIF OLD.`minimal_prices_of_click_28` != NEW.`minimal_prices_of_click_28` THEN\n    SET NEW.`updated_time` = NOW();\nEND IF;\n\nIF OLD.`minimal_prices_of_click_29` != NEW.`minimal_prices_of_click_29` THEN\n    SET NEW.`updated_time` = NOW();\nEND IF;\n\nIF OLD.`category_platform` != NEW.`category_platform` THEN\n    SET NEW.`updated_time` = NOW();\nEND IF;\n\nIF OLD.`mirror` != NEW.`mirror` THEN\n    SET NEW.`updated_time` = NOW();\n    IF NEW.`mirror` = \'trafficmedia\' THEN\n    	SET NEW.`only_own_subnet` = 1;\n    END IF;\nEND IF;\n\nIF OLD.`subnet` != NEW.`subnet` THEN\n    SET NEW.`updated_time` = NOW();\nEND IF;\n\nIF OLD.`debug_info_on` != NEW.`debug_info_on` THEN\n    SET NEW.`updated_time` = NOW();\nEND IF;\n\nIF OLD.`client_id` != NEW.`client_id` THEN\n    SET NEW.`updated_time` = NOW();\nEND IF;\n\nIF NEW.`count_news` > 120 THEN\n    SET NEW.`count_news` = 120;\nEND IF;\n\nIF OLD.`revenue_proc` != NEW.`revenue_proc` THEN\n    SET NEW.`updated_time` = NOW();\nEND IF;\n\nIF OLD.`no_calc_ghits_ctr` != NEW.`no_calc_ghits_ctr` THEN\n    SET NEW.`updated_time` = NOW();\nEND IF;\n\nIF OLD.`female_content` != NEW.`female_content` THEN\n    SET NEW.`updated_time` = NOW();\nEND IF;\n\nIF OLD.`show_cpc` != NEW.`show_cpc` THEN\n    SET NEW.`updated_time` = NOW();\nEND IF;\n\nIF OLD.`show_probability_satellite` != NEW.`show_probability_satellite` THEN\n    SET NEW.`updated_time` = NOW();\nEND IF;\n\nIF OLD.`image_format` != NEW.`image_format` THEN\n    SET NEW.`updated_time` = NOW();\nEND IF;\n\nIF OLD.`response_algorithm` != NEW.`response_algorithm` THEN\n    SET NEW.`updated_time` = NOW();\nEND IF;\n\nIF OLD.`disable_cheating_suspicion` != NEW.`disable_cheating_suspicion` THEN\n    SET NEW.`updated_time` = NOW();\nEND IF;\n\nIF NEW.`tickers_composite_id` IS NOT NULL AND NOT (NEW.`tickers_composite_id` <=> OLD.`tickers_composite_id`) THEN\n    SET NEW.`class` = \'composite\';\n    SET NEW.`parent` = NEW.`tickers_composite_id`;\nEND IF;\n\nIF NEW.`tickers_composite_id` IS NOT NULL AND NEW.`tickers_under_id` IS NOT NULL THEN\n    SIGNAL SQLSTATE \'45000\' SET MESSAGE_TEXT = "Widget can\'t have composite id and under id filled simultaneously";\nEND IF;\n\nEND' 'CREATE DEFINER=`root`@`localhost` TRIGGER `test_partners`.`g_blocks_changes`\nAFTER UPDATE\nON `g_blocks`\nFOR EACH ROW\nBEGIN\n  IF @auth_login = \'cron\' THEN\n      INSERT INTO `test_partners_changes`.`cron_us_alert`(id, `who_change`) VALUES(null, @auth_login);\n  END IF;\n\nSET @calcHash := IFNULL( @calcHash, USER() NOT LIKE \'perl_ghits%\' AND USER() NOT LIKE \'goodsblock%\' AND USER() NOT LIKE \'ssp%\');\n\nIF @calcHash THEN\n  SET @oldHash = MD5(CONCAT_WS(\',\', OLD.mirror, OLD.subnet, OLD.iframe, OLD.contracts_type, OLD.minimal_price_of_click, OLD.minimal_prices_of_click_0, OLD.minimal_prices_of_click_1, OLD.minimal_prices_of_click_2, OLD.minimal_prices_of_click_3, OLD.minimal_prices_of_click_4, OLD.minimal_prices_of_click_5, OLD.minimal_prices_of_click_6, OLD.minimal_prices_of_click_7, OLD.minimal_prices_of_click_8, OLD.minimal_prices_of_click_9, OLD.minimal_prices_of_click_10, OLD.minimal_prices_of_click_11, OLD.minimal_prices_of_click_12, OLD.minimal_prices_of_click_13, OLD.minimal_prices_of_click_14, OLD.minimal_prices_of_click_15, OLD.minimal_prices_of_click_16, OLD.minimal_prices_of_click_17, OLD.minimal_prices_of_click_18, OLD.minimal_prices_of_click_19, OLD.minimal_prices_of_click_20, OLD.minimal_prices_of_click_21, OLD.minimal_prices_of_click_22, OLD.minimal_prices_of_click_23, OLD.minimal_prices_of_click_24, OLD.minimal_prices_of_click_25, OLD.minimal_prices_of_click_26, OLD.minimal_prices_of_click_27, OLD.minimal_prices_of_click_28, OLD.minimal_prices_of_click_29, OLD.without_green_ghits, OLD.only_green_ghits, OLD.elastic, OLD.styles, OLD.template, OLD.opacity, OLD.position, OLD.xml, OLD.use_tranz_page, OLD.popunder, OLD.animation, OLD.use_cat, OLD.filter_2, OLD.count_news, OLD.show_description, OLD.iframe, OLD.autorefresh, OLD.only_own_subnet, OLD.quality_factor, OLD.female_content, OLD.ads_filter, OLD.image_format, OLD.scale_photo_image_format, OLD.ad_types, OLD.native_redirector, OLD.native_redirector_url, OLD.duplicates_count, OLD.paginator, OLD.pages_count));  \n  SET @newHash = MD5(CONCAT_WS(\',\', NEW.mirror, NEW.subnet, NEW.iframe, NEW.contracts_type, NEW.minimal_price_of_click, NEW.minimal_prices_of_click_0, NEW.minimal_prices_of_click_1, NEW.minimal_prices_of_click_2, NEW.minimal_prices_of_click_3, NEW.minimal_prices_of_click_4, NEW.minimal_prices_of_click_5, NEW.minimal_prices_of_click_6, NEW.minimal_prices_of_click_7, NEW.minimal_prices_of_click_8, NEW.minimal_prices_of_click_9, NEW.minimal_prices_of_click_10, NEW.minimal_prices_of_click_11, NEW.minimal_prices_of_click_12, NEW.minimal_prices_of_click_13, NEW.minimal_prices_of_click_14, NEW.minimal_prices_of_click_15, NEW.minimal_prices_of_click_16, NEW.minimal_prices_of_click_17, NEW.minimal_prices_of_click_18, NEW.minimal_prices_of_click_19, NEW.minimal_prices_of_click_20, NEW.minimal_prices_of_click_21, NEW.minimal_prices_of_click_22, NEW.minimal_prices_of_click_23, NEW.minimal_prices_of_click_24, NEW.minimal_prices_of_click_25, NEW.minimal_prices_of_click_26, NEW.minimal_prices_of_click_27, NEW.minimal_prices_of_click_28, NEW.minimal_prices_of_click_29, NEW.without_green_ghits, NEW.only_green_ghits, NEW.elastic, NEW.styles, NEW.template, NEW.opacity, NEW.position, NEW.xml, NEW.use_tranz_page, NEW.popunder, NEW.animation, NEW.use_cat, NEW.filter_2, NEW.count_news, NEW.show_description, NEW.iframe, NEW.autorefresh, NEW.only_own_subnet, NEW.quality_factor, NEW.female_content, NEW.ads_filter, NEW.image_format, NEW.scale_photo_image_format, NEW.ad_types, NEW.native_redirector, NEW.native_redirector_url, NEW.duplicates_count, NEW.paginator, NEW.pages_count));\n  IF @oldHash <> @newHash THEN\n    DELETE FROM test_partners_plus.g_blocks_cpm_statistics_page WHERE informer_uid = NEW.uid;\n    DELETE FROM test_partners_plus.g_blocks_cpm_statistics_page_time WHERE informer_uid = NEW.uid;\n    INSERT INTO `test_partners_changes`.`g_blocks_changes`(`informer`, `uid_informer`, `field`, `old_value`, `new_value`, `when`, `who`) \n        VALUES (NEW.id, NEW.`uid`, \'cpm_stat_drop_hash\',CONCAT_WS(\',\', OLD.mirror, OLD.subnet, OLD.iframe, OLD.contracts_type, OLD.minimal_price_of_click, OLD.minimal_prices_of_click_0, OLD.minimal_prices_of_click_1, OLD.minimal_prices_of_click_2, OLD.minimal_prices_of_click_3, OLD.minimal_prices_of_click_4, OLD.minimal_prices_of_click_5, OLD.minimal_prices_of_click_6, OLD.minimal_prices_of_click_7, OLD.minimal_prices_of_click_8, OLD.minimal_prices_of_click_9, OLD.minimal_prices_of_click_10, OLD.minimal_prices_of_click_11, OLD.minimal_prices_of_click_12, OLD.minimal_prices_of_click_13, OLD.minimal_prices_of_click_14, OLD.minimal_prices_of_click_15, OLD.minimal_prices_of_click_16, OLD.minimal_prices_of_click_17, OLD.minimal_prices_of_click_18, OLD.minimal_prices_of_click_19, OLD.minimal_prices_of_click_20, OLD.minimal_prices_of_click_21, OLD.minimal_prices_of_click_22, OLD.minimal_prices_of_click_23, OLD.minimal_prices_of_click_24, OLD.minimal_prices_of_click_25, OLD.minimal_prices_of_click_26, OLD.minimal_prices_of_click_27, OLD.minimal_prices_of_click_28, OLD.minimal_prices_of_click_29, OLD.without_green_ghits, OLD.only_green_ghits, OLD.elastic, OLD.opacity, OLD.position, OLD.xml, OLD.use_tranz_page, OLD.popunder, OLD.animation, OLD.use_cat, OLD.filter_2, OLD.count_news, OLD.show_description, OLD.iframe, OLD.autorefresh, OLD.only_own_subnet, OLD.quality_factor, OLD.female_content, OLD.ads_filter, OLD.image_format, OLD.scale_photo_image_format, OLD.ad_types, OLD.native_redirector, OLD.native_redirector_url, OLD.duplicates_count, OLD.paginator, OLD.pages_count), CONCAT_WS(\',\', NEW.mirror, NEW.subnet, NEW.iframe, NEW.contracts_type, NEW.minimal_price_of_click, NEW.minimal_prices_of_click_0, NEW.minimal_prices_of_click_1, NEW.minimal_prices_of_click_2, NEW.minimal_prices_of_click_3, NEW.minimal_prices_of_click_4, NEW.minimal_prices_of_click_5, NEW.minimal_prices_of_click_6, NEW.minimal_prices_of_click_7, NEW.minimal_prices_of_click_8, NEW.minimal_prices_of_click_9, NEW.minimal_prices_of_click_10, NEW.minimal_prices_of_click_11, NEW.minimal_prices_of_click_12, NEW.minimal_prices_of_click_13, NEW.minimal_prices_of_click_14, NEW.minimal_prices_of_click_15, NEW.minimal_prices_of_click_16, NEW.minimal_prices_of_click_17, NEW.minimal_prices_of_click_18, NEW.minimal_prices_of_click_19, NEW.minimal_prices_of_click_20, NEW.minimal_prices_of_click_21, NEW.minimal_prices_of_click_22, NEW.minimal_prices_of_click_23, NEW.minimal_prices_of_click_24, NEW.minimal_prices_of_click_25, NEW.minimal_prices_of_click_26, NEW.minimal_prices_of_click_27, NEW.minimal_prices_of_click_28, NEW.minimal_prices_of_click_29, NEW.without_green_ghits, NEW.only_green_ghits, NEW.elastic, NEW.opacity, NEW.position, NEW.xml, NEW.use_tranz_page, NEW.popunder, NEW.animation, NEW.use_cat, NEW.filter_2, NEW.count_news, NEW.show_description, NEW.iframe, NEW.autorefresh, NEW.only_own_subnet, NEW.quality_factor, NEW.female_content, NEW.ads_filter, NEW.image_format, NEW.scale_photo_image_format, NEW.ad_types, NEW.native_redirector, NEW.native_redirector_url, NEW.duplicates_count, NEW.paginator, NEW.pages_count) , NOW(), @auth_login);\n  END IF;\nEND IF;\n\n\nIF @auth_login IS null AND OLD.has_sources != NEW.has_sources THEN\n    INSERT INTO `test_partners_changes`.`null_who_change_has_sources`(id, `who_change`) VALUES(null, @auth_login);\nEND IF;\n\n  IF OLD.id != NEW.id THEN\n    INSERT INTO `test_partners_changes`.`g_blocks_changes` (`informer`, `uid_informer`, `who`, `field`, `old_value`, `when`, `new_value`)\n      VALUES (NEW.id, NEW.`uid`, @auth_login, \'id\', OLD.id, NOW(), NEW.id);\n  END IF;\n  IF NOT OLD.name <=> NEW.name THEN\n    INSERT INTO `test_partners_changes`.`g_blocks_changes` (`informer`, `uid_informer`, `who`, `field`, `old_value`, `when`, `new_value`)\n      VALUES (NEW.id, NEW.`uid`, @auth_login, \'name\', IF(OLD.name IS NOT NULL, OLD.name, \'\'), NOW(), IF(NEW.name IS NOT NULL, NEW.name, \'\'));\n  END IF;\n  IF NOT OLD.description <=> NEW.description THEN\n    INSERT INTO `test_partners_changes`.`g_blocks_changes` (`informer`, `uid_informer`, `who`, `field`, `old_value`, `when`, `new_value`)\n      VALUES (NEW.id, NEW.`uid`, @auth_login, \'description\', IF(OLD.description IS NOT NULL, OLD.description, \'\'), NOW(), IF(NEW.description IS NOT NULL, NEW.description, \'\'));\n  END IF;\n  IF OLD.use_cat != NEW.use_cat THEN\n    INSERT INTO `test_partners_changes`.`g_blocks_changes` (`informer`, `uid_informer`, `who`, `field`, `old_value`, `when`, `new_value`)\n      VALUES (NEW.id, NEW.`uid`, @auth_login, \'use_cat\', OLD.use_cat, NOW(), NEW.use_cat);\n  END IF;\n  IF OLD.count_news != NEW.count_news THEN\n    INSERT INTO `test_partners_changes`.`g_blocks_changes` (`informer`, `uid_informer`, `who`, `field`, `old_value`, `when`, `new_value`)\n      VALUES (NEW.id, NEW.`uid`, @auth_login, \'count_news\', OLD.count_news, NOW(), NEW.count_news);\n	CALL pr_g_blocks_count_news(NEW.id, OLD.count_news, NEW.count_news);\n  END IF;\n  IF OLD.filter_2 != NEW.filter_2 THEN\n    INSERT INTO `test_partners_changes`.`g_blocks_changes` (`informer`, `uid_informer`, `who`, `field`, `old_value`, `when`, `new_value`)\n      VALUES (NEW.id, NEW.`uid`, @auth_login, \'filter_2\', OLD.filter_2, NOW(), NEW.filter_2);\n  END IF;\n  IF OLD.show_source != NEW.show_source THEN\n    INSERT INTO `test_partners_changes`.`g_blocks_changes` (`informer`, `uid_informer`, `who`, `field`, `old_value`, `when`, `new_value`)\n      VALUES (NEW.id, NEW.`uid`, @auth_login, \'show_source\', OLD.show_source, NOW(), NEW.show_source);\n  END IF;\n  IF OLD.show_description != NEW.show_description THEN\n    INSERT INTO `test_partners_changes`.`g_blocks_changes` (`informer`, `uid_informer`, `who`, `field`, `old_value`, `when`, `new_value`)\n      VALUES (NEW.id, NEW.`uid`, @auth_login, \'show_description\', OLD.show_description, NOW(), NEW.show_description);\n  END IF;\n  IF OLD.show_photo != NEW.show_photo THEN\n    INSERT INTO `test_partners_changes`.`g_blocks_changes` (`informer`, `uid_informer`, `who`, `field`, `old_value`, `when`, `new_value`)\n      VALUES (NEW.id, NEW.`uid`, @auth_login, \'show_photo\', OLD.show_photo, NOW(), NEW.show_photo);\n  END IF;\n  IF OLD.photo_only != NEW.photo_only THEN\n    INSERT INTO `test_partners_changes`.`g_blocks_changes` (`informer`, `uid_informer`, `who`, `field`, `old_value`, `when`, `new_value`)\n      VALUES (NEW.id, NEW.`uid`, @auth_login, \'photo_only\', OLD.photo_only, NOW(), NEW.photo_only);\n  END IF;\n  IF NOT OLD.code_js <=> NEW.code_js THEN\n    INSERT INTO `test_partners_changes`.`g_blocks_changes` (`informer`, `uid_informer`, `who`, `field`, `old_value`, `when`, `new_value`)\n      VALUES (NEW.id, NEW.`uid`, @auth_login, \'code_js\', IF(OLD.code_js IS NOT NULL, OLD.code_js, \'\'), NOW(), IF(NEW.code_js IS NOT NULL, NEW.code_js, \'\'));\n  END IF;\n  IF OLD.creator != NEW.creator THEN\n    INSERT INTO `test_partners_changes`.`g_blocks_changes` (`informer`, `uid_informer`, `who`, `field`, `old_value`, `when`, `new_value`)\n      VALUES (NEW.id, NEW.`uid`, @auth_login, \'creator\', OLD.creator, NOW(), NEW.creator);\n  END IF;\n  IF OLD.editor != NEW.editor THEN\n    INSERT INTO `test_partners_changes`.`g_blocks_changes` (`informer`, `uid_informer`, `who`, `field`, `old_value`, `when`, `new_value`)\n      VALUES (NEW.id, NEW.`uid`, @auth_login, \'editor\', OLD.editor, NOW(), NEW.editor);\n  END IF;\n  IF OLD.big_photo != NEW.big_photo THEN\n    INSERT INTO `test_partners_changes`.`g_blocks_changes` (`informer`, `uid_informer`, `who`, `field`, `old_value`, `when`, `new_value`)\n      VALUES (NEW.id, NEW.`uid`, @auth_login, \'big_photo\', OLD.big_photo, NOW(), NEW.big_photo);\n  END IF;\n  IF OLD.animation != NEW.animation THEN\n    INSERT INTO `test_partners_changes`.`g_blocks_changes` (`informer`, `uid_informer`, `who`, `field`, `old_value`, `when`, `new_value`)\n      VALUES (NEW.id, NEW.`uid`, @auth_login, \'animation\', OLD.animation, NOW(), NEW.animation);\n  END IF;\n  IF OLD.xml != NEW.xml THEN\n    INSERT INTO `test_partners_changes`.`g_blocks_changes` (`informer`, `uid_informer`, `who`, `field`, `old_value`, `when`, `new_value`)\n      VALUES (NEW.id, NEW.`uid`, @auth_login, \'xml\', OLD.xml, NOW(), NEW.xml);\n  END IF;\n  IF OLD.status != NEW.status THEN\n    INSERT INTO `test_partners_changes`.`g_blocks_changes` (`informer`, `uid_informer`, `who`, `field`, `old_value`, `when`, `new_value`)\n      VALUES (NEW.id, NEW.`uid`, @auth_login, \'status\', OLD.status, NOW(), NEW.status);\n  END IF;\n  IF OLD.img_type != NEW.img_type THEN\n    INSERT INTO `test_partners_changes`.`g_blocks_changes` (`informer`, `uid_informer`, `who`, `field`, `old_value`, `when`, `new_value`)\n      VALUES (NEW.id, NEW.`uid`, @auth_login, \'img_type\', OLD.img_type, NOW(), NEW.img_type);\n  END IF;\n  IF OLD.title_limit != NEW.title_limit THEN\n    INSERT INTO `test_partners_changes`.`g_blocks_changes` (`informer`, `uid_informer`, `who`, `field`, `old_value`, `when`, `new_value`)\n      VALUES (NEW.id, NEW.`uid`, @auth_login, \'title_limit\', OLD.title_limit, NOW(), NEW.title_limit);\n  END IF;\n  IF OLD.title_break != NEW.title_break THEN\n    INSERT INTO `test_partners_changes`.`g_blocks_changes` (`informer`, `uid_informer`, `who`, `field`, `old_value`, `when`, `new_value`)\n      VALUES (NEW.id, NEW.`uid`, @auth_login, \'title_break\', OLD.title_break, NOW(), NEW.title_break);\n  END IF;\n  IF OLD.desc_limit != NEW.desc_limit THEN\n    INSERT INTO `test_partners_changes`.`g_blocks_changes` (`informer`, `uid_informer`, `who`, `field`, `old_value`, `when`, `new_value`)\n      VALUES (NEW.id, NEW.`uid`, @auth_login, \'desc_limit\', OLD.desc_limit, NOW(), NEW.desc_limit);\n  END IF;\n  IF OLD.desc_break != NEW.desc_break THEN\n    INSERT INTO `test_partners_changes`.`g_blocks_changes` (`informer`, `uid_informer`, `who`, `field`, `old_value`, `when`, `new_value`)\n      VALUES (NEW.id, NEW.`uid`, @auth_login, \'desc_break\', OLD.desc_break, NOW(), NEW.desc_break);\n  END IF;\n  IF OLD.pmc_page != NEW.pmc_page THEN\n    INSERT INTO `test_partners_changes`.`g_blocks_changes` (`informer`, `uid_informer`, `who`, `field`, `old_value`, `when`, `new_value`)\n      VALUES (NEW.id, NEW.`uid`, @auth_login, \'pmc_page\', OLD.pmc_page, NOW(), NEW.pmc_page);\n  END IF;\n  IF OLD.opacity != NEW.opacity THEN\n    INSERT INTO `test_partners_changes`.`g_blocks_changes` (`informer`, `uid_informer`, `who`, `field`, `old_value`, `when`, `new_value`)\n      VALUES (NEW.id, NEW.`uid`, @auth_login, \'opacity\', OLD.opacity, NOW(), NEW.opacity);\n  END IF;\n  IF OLD.position != NEW.position THEN\n    INSERT INTO `test_partners_changes`.`g_blocks_changes` (`informer`, `uid_informer`, `who`, `field`, `old_value`, `when`, `new_value`)\n      VALUES (NEW.id, NEW.`uid`, @auth_login, \'position\', OLD.position, NOW(), NEW.position);\n  END IF;\n  IF OLD.elastic != NEW.elastic THEN\n    INSERT INTO `test_partners_changes`.`g_blocks_changes` (`informer`, `uid_informer`, `who`, `field`, `old_value`, `when`, `new_value`)\n      VALUES (NEW.id, NEW.`uid`, @auth_login, \'elastic\', OLD.elastic, NOW(), NEW.elastic);\n  END IF;\n  IF OLD.enabled != NEW.enabled THEN\n    INSERT INTO `test_partners_changes`.`g_blocks_changes` (`informer`, `uid_informer`, `who`, `field`, `old_value`, `when`, `new_value`)\n      VALUES (NEW.id, NEW.`uid`, @auth_login, \'enabled\', OLD.enabled, NOW(), NEW.enabled);\n  END IF;\n  IF OLD.minimal_prices_of_click_0 != NEW.minimal_prices_of_click_0 THEN\n    INSERT INTO `test_partners_changes`.`g_blocks_changes` (`informer`, `uid_informer`, `who`, `field`, `old_value`, `when`, `new_value`)\n      VALUES (NEW.id, NEW.`uid`, @auth_login, \'minimal_prices_of_click_0\', OLD.minimal_prices_of_click_0, NOW(), NEW.minimal_prices_of_click_0);\n  END IF;\n  IF OLD.minimal_prices_of_click_1 != NEW.minimal_prices_of_click_1 THEN\n    INSERT INTO `test_partners_changes`.`g_blocks_changes` (`informer`, `uid_informer`, `who`, `field`, `old_value`, `when`, `new_value`)\n      VALUES (NEW.id, NEW.`uid`, @auth_login, \'minimal_prices_of_click_1\', OLD.minimal_prices_of_click_1, NOW(), NEW.minimal_prices_of_click_1);\n  END IF;\n  IF OLD.minimal_prices_of_click_2 != NEW.minimal_prices_of_click_2 THEN\n    INSERT INTO `test_partners_changes`.`g_blocks_changes` (`informer`, `uid_informer`, `who`, `field`, `old_value`, `when`, `new_value`)\n      VALUES (NEW.id, NEW.`uid`, @auth_login, \'minimal_prices_of_click_2\', OLD.minimal_prices_of_click_2, NOW(), NEW.minimal_prices_of_click_2);\n  END IF;\n  IF OLD.minimal_prices_of_click_3 != NEW.minimal_prices_of_click_3 THEN\n    INSERT INTO `test_partners_changes`.`g_blocks_changes` (`informer`, `uid_informer`, `who`, `field`, `old_value`, `when`, `new_value`)\n      VALUES (NEW.id, NEW.`uid`, @auth_login, \'minimal_prices_of_click_3\', OLD.minimal_prices_of_click_3, NOW(), NEW.minimal_prices_of_click_3);\n  END IF;\n  IF OLD.minimal_prices_of_click_4 != NEW.minimal_prices_of_click_4 THEN\n    INSERT INTO `test_partners_changes`.`g_blocks_changes` (`informer`, `uid_informer`, `who`, `field`, `old_value`, `when`, `new_value`)\n      VALUES (NEW.id, NEW.`uid`, @auth_login, \'minimal_prices_of_click_4\', OLD.minimal_prices_of_click_4, NOW(), NEW.minimal_prices_of_click_4);\n  END IF;\n  IF OLD.minimal_prices_of_click_5 != NEW.minimal_prices_of_click_5 THEN\n    INSERT INTO `test_partners_changes`.`g_blocks_changes` (`informer`, `uid_informer`, `who`, `field`, `old_value`, `when`, `new_value`)\n      VALUES (NEW.id, NEW.`uid`, @auth_login, \'minimal_prices_of_click_5\', OLD.minimal_prices_of_click_5, NOW(), NEW.minimal_prices_of_click_5);\n  END IF;\n  IF OLD.minimal_prices_of_click_6 != NEW.minimal_prices_of_click_6 THEN\n    INSERT INTO `test_partners_changes`.`g_blocks_changes` (`informer`, `uid_informer`, `who`, `field`, `old_value`, `when`, `new_value`)\n      VALUES (NEW.id, NEW.`uid`, @auth_login, \'minimal_prices_of_click_6\', OLD.minimal_prices_of_click_6, NOW(), NEW.minimal_prices_of_click_6);\n  END IF;\n  IF OLD.minimal_prices_of_click_7 != NEW.minimal_prices_of_click_7 THEN\n    INSERT INTO `test_partners_changes`.`g_blocks_changes` (`informer`, `uid_informer`, `who`, `field`, `old_value`, `when`, `new_value`)\n      VALUES (NEW.id, NEW.`uid`, @auth_login, \'minimal_prices_of_click_7\', OLD.minimal_prices_of_click_7, NOW(), NEW.minimal_prices_of_click_7);\n  END IF;\n  IF OLD.minimal_prices_of_click_8 != NEW.minimal_prices_of_click_8 THEN\n    INSERT INTO `test_partners_changes`.`g_blocks_changes` (`informer`, `uid_informer`, `who`, `field`, `old_value`, `when`, `new_value`)\n      VALUES (NEW.id, NEW.`uid`, @auth_login, \'minimal_prices_of_click_8\', OLD.minimal_prices_of_click_8, NOW(), NEW.minimal_prices_of_click_8);\n  END IF;\n  IF OLD.minimal_prices_of_click_9 != NEW.minimal_prices_of_click_9 THEN\n    INSERT INTO `test_partners_changes`.`g_blocks_changes` (`informer`, `uid_informer`, `who`, `field`, `old_value`, `when`, `new_value`)\n      VALUES (NEW.id, NEW.`uid`, @auth_login, \'minimal_prices_of_click_9\', OLD.minimal_prices_of_click_9, NOW(), NEW.minimal_prices_of_click_9);\n  END IF;\n  IF OLD.minimal_prices_of_click_10 != NEW.minimal_prices_of_click_10 THEN\n    INSERT INTO `test_partners_changes`.`g_blocks_changes` (`informer`, `uid_informer`, `who`, `field`, `old_value`, `when`, `new_value`)\n      VALUES (NEW.id, NEW.`uid`, @auth_login, \'minimal_prices_of_click_10\', OLD.minimal_prices_of_click_10, NOW(), NEW.minimal_prices_of_click_10);\n  END IF;\n  IF OLD.minimal_prices_of_click_11 != NEW.minimal_prices_of_click_11 THEN\n    INSERT INTO `test_partners_changes`.`g_blocks_changes` (`informer`, `uid_informer`, `who`, `field`, `old_value`, `when`, `new_value`)\n      VALUES (NEW.id, NEW.`uid`, @auth_login, \'minimal_prices_of_click_11\', OLD.minimal_prices_of_click_11, NOW(), NEW.minimal_prices_of_click_11);\n  END IF;\n  IF OLD.minimal_prices_of_click_12 != NEW.minimal_prices_of_click_12 THEN\n    INSERT INTO `test_partners_changes`.`g_blocks_changes` (`informer`, `uid_informer`, `who`, `field`, `old_value`, `when`, `new_value`)\n      VALUES (NEW.id, NEW.`uid`, @auth_login, \'minimal_prices_of_click_12\', OLD.minimal_prices_of_click_12, NOW(), NEW.minimal_prices_of_click_12);\n  END IF;\n  IF OLD.minimal_prices_of_click_13 != NEW.minimal_prices_of_click_13 THEN\n    INSERT INTO `test_partners_changes`.`g_blocks_changes` (`informer`, `uid_informer`, `who`, `field`, `old_value`, `when`, `new_value`)\n      VALUES (NEW.id, NEW.`uid`, @auth_login, \'minimal_prices_of_click_13\', OLD.minimal_prices_of_click_13, NOW(), NEW.minimal_prices_of_click_13);\n  END IF;\n  IF OLD.minimal_prices_of_click_14 != NEW.minimal_prices_of_click_14 THEN\n    INSERT INTO `test_partners_changes`.`g_blocks_changes` (`informer`, `uid_informer`, `who`, `field`, `old_value`, `when`, `new_value`)\n      VALUES (NEW.id, NEW.`uid`, @auth_login, \'minimal_prices_of_click_14\', OLD.minimal_prices_of_click_14, NOW(), NEW.minimal_prices_of_click_14);\n  END IF;\n  IF OLD.minimal_prices_of_click_15 != NEW.minimal_prices_of_click_15 THEN\n    INSERT INTO `test_partners_changes`.`g_blocks_changes` (`informer`, `uid_informer`, `who`, `field`, `old_value`, `when`, `new_value`)\n      VALUES (NEW.id, NEW.`uid`, @auth_login, \'minimal_prices_of_click_15\', OLD.minimal_prices_of_click_15, NOW(), NEW.minimal_prices_of_click_15);\n  END IF;\n  IF OLD.minimal_prices_of_click_16 != NEW.minimal_prices_of_click_16 THEN\n    INSERT INTO `test_partners_changes`.`g_blocks_changes` (`informer`, `uid_informer`, `who`, `field`, `old_value`, `when`, `new_value`)\n      VALUES (NEW.id, NEW.`uid`, @auth_login, \'minimal_prices_of_click_16\', OLD.minimal_prices_of_click_16, NOW(), NEW.minimal_prices_of_click_16);\n  END IF;\n  IF OLD.minimal_prices_of_click_17 != NEW.minimal_prices_of_click_17 THEN\n    INSERT INTO `test_partners_changes`.`g_blocks_changes` (`informer`, `uid_informer`, `who`, `field`, `old_value`, `when`, `new_value`)\n      VALUES (NEW.id, NEW.`uid`, @auth_login, \'minimal_prices_of_click_17\', OLD.minimal_prices_of_click_17, NOW(), NEW.minimal_prices_of_click_17);\n  END IF;\n  IF OLD.minimal_prices_of_click_18 != NEW.minimal_prices_of_click_18 THEN\n    INSERT INTO `test_partners_changes`.`g_blocks_changes` (`informer`, `uid_informer`, `who`, `field`, `old_value`, `when`, `new_value`)\n      VALUES (NEW.id, NEW.`uid`, @auth_login, \'minimal_prices_of_click_18\', OLD.minimal_prices_of_click_18, NOW(), NEW.minimal_prices_of_click_18);\n  END IF;\n  IF OLD.minimal_prices_of_click_19 != NEW.minimal_prices_of_click_19 THEN\n    INSERT INTO `test_partners_changes`.`g_blocks_changes` (`informer`, `uid_informer`, `who`, `field`, `old_value`, `when`, `new_value`)\n      VALUES (NEW.id, NEW.`uid`, @auth_login, \'minimal_prices_of_click_19\', OLD.minimal_prices_of_click_19, NOW(), NEW.minimal_prices_of_click_19);\n  END IF;\n  IF OLD.minimal_prices_of_click_20 != NEW.minimal_prices_of_click_20 THEN\n    INSERT INTO `test_partners_changes`.`g_blocks_changes` (`informer`, `uid_informer`, `who`, `field`, `old_value`, `when`, `new_value`)\n      VALUES (NEW.id, NEW.`uid`, @auth_login, \'minimal_prices_of_click_20\', OLD.minimal_prices_of_click_20, NOW(), NEW.minimal_prices_of_click_20);\n  END IF;\n  IF OLD.minimal_prices_of_click_21 != NEW.minimal_prices_of_click_21 THEN\n    INSERT INTO `test_partners_changes`.`g_blocks_changes` (`informer`, `uid_informer`, `who`, `field`, `old_value`, `when`, `new_value`)\n      VALUES (NEW.id, NEW.`uid`, @auth_login, \'minimal_prices_of_click_21\', OLD.minimal_prices_of_click_21, NOW(), NEW.minimal_prices_of_click_21);\n  END IF;\n  IF OLD.minimal_prices_of_click_22 != NEW.minimal_prices_of_click_22 THEN\n    INSERT INTO `test_partners_changes`.`g_blocks_changes` (`informer`, `uid_informer`, `who`, `field`, `old_value`, `when`, `new_value`)\n      VALUES (NEW.id, NEW.`uid`, @auth_login, \'minimal_prices_of_click_22\', OLD.minimal_prices_of_click_22, NOW(), NEW.minimal_prices_of_click_22);\n  END IF;\n  IF OLD.minimal_prices_of_click_23 != NEW.minimal_prices_of_click_23 THEN\n    INSERT INTO `test_partners_changes`.`g_blocks_changes` (`informer`, `uid_informer`, `who`, `field`, `old_value`, `when`, `new_value`)\n      VALUES (NEW.id, NEW.`uid`, @auth_login, \'minimal_prices_of_click_23\', OLD.minimal_prices_of_click_23, NOW(), NEW.minimal_prices_of_click_23);\n  END IF;\n  IF OLD.minimal_prices_of_click_24 != NEW.minimal_prices_of_click_24 THEN\n    INSERT INTO `test_partners_changes`.`g_blocks_changes` (`informer`, `uid_informer`, `who`, `field`, `old_value`, `when`, `new_value`)\n      VALUES (NEW.id, NEW.`uid`, @auth_login, \'minimal_prices_of_click_24\', OLD.minimal_prices_of_click_24, NOW(), NEW.minimal_prices_of_click_24);\n  END IF;\n  IF OLD.minimal_prices_of_click_25 != NEW.minimal_prices_of_click_25 THEN\n    INSERT INTO `test_partners_changes`.`g_blocks_changes` (`informer`, `uid_informer`, `who`, `field`, `old_value`, `when`, `new_value`)\n      VALUES (NEW.id, NEW.`uid`, @auth_login, \'minimal_prices_of_click_25\', OLD.minimal_prices_of_click_25, NOW(), NEW.minimal_prices_of_click_25);\n  END IF;\n  IF OLD.minimal_prices_of_click_26 != NEW.minimal_prices_of_click_26 THEN\n    INSERT INTO `test_partners_changes`.`g_blocks_changes` (`informer`, `uid_informer`, `who`, `field`, `old_value`, `when`, `new_value`)\n      VALUES (NEW.id, NEW.`uid`, @auth_login, \'minimal_prices_of_click_26\', OLD.minimal_prices_of_click_26, NOW(), NEW.minimal_prices_of_click_26);\n  END IF;\n  IF OLD.minimal_prices_of_click_27 != NEW.minimal_prices_of_click_27 THEN\n    INSERT INTO `test_partners_changes`.`g_blocks_changes` (`informer`, `uid_informer`, `who`, `field`, `old_value`, `when`, `new_value`)\n      VALUES (NEW.id, NEW.`uid`, @auth_login, \'minimal_prices_of_click_27\', OLD.minimal_prices_of_click_27, NOW(), NEW.minimal_prices_of_click_27);\n  END IF;\n  IF OLD.minimal_prices_of_click_28 != NEW.minimal_prices_of_click_28 THEN\n    INSERT INTO `test_partners_changes`.`g_blocks_changes` (`informer`, `uid_informer`, `who`, `field`, `old_value`, `when`, `new_value`)\n      VALUES (NEW.id, NEW.`uid`, @auth_login, \'minimal_prices_of_click_28\', OLD.minimal_prices_of_click_28, NOW(), NEW.minimal_prices_of_click_28);\n  END IF;\n  IF OLD.minimal_prices_of_click_29 != NEW.minimal_prices_of_click_29 THEN\n    INSERT INTO `test_partners_changes`.`g_blocks_changes` (`informer`, `uid_informer`, `who`, `field`, `old_value`, `when`, `new_value`)\n      VALUES (NEW.id, NEW.`uid`, @auth_login, \'minimal_prices_of_click_29\', OLD.minimal_prices_of_click_29, NOW(), NEW.minimal_prices_of_click_29);\n  END IF;\n  IF OLD.agent_ghits_wages_topartner != NEW.agent_ghits_wages_topartner THEN\n    INSERT INTO `test_partners_changes`.`g_blocks_changes` (`informer`, `uid_informer`, `who`, `field`, `old_value`, `when`, `new_value`)\n      VALUES (NEW.id, NEW.`uid`, @auth_login, \'agent_ghits_wages_topartner\', OLD.agent_ghits_wages_topartner, NOW(), NEW.agent_ghits_wages_topartner);\n  END IF;\n\n  IF OLD.wrong_clicks_enabled != NEW.wrong_clicks_enabled THEN\n    INSERT INTO `test_partners_changes`.`g_blocks_changes` (`informer`, `uid_informer`, `who`, `field`, `old_value`, `when`, `new_value`)\n      VALUES (NEW.id, NEW.`uid`, @auth_login, \'wrong_clicks_enabled\', OLD.wrong_clicks_enabled, NOW(), NEW.wrong_clicks_enabled);\n  END IF;\n\n  IF OLD.subnet != NEW.subnet THEN\n    INSERT INTO `test_partners_changes`.`g_blocks_changes` (`informer`, `uid_informer`, `who`, `field`, `old_value`, `when`, `new_value`)\n      VALUES (NEW.id, NEW.`uid`, @auth_login, \'subnet\', OLD.subnet, NOW(), NEW.subnet);\n  END IF;\n\n  IF OLD.use_tranz_page != NEW.use_tranz_page THEN\n    INSERT INTO `test_partners_changes`.`g_blocks_changes` (`informer`, `uid_informer`, `who`, `field`, `old_value`, `when`, `new_value`)\n      VALUES (NEW.id, NEW.`uid`, @auth_login, \'use_tranz_page\', OLD.use_tranz_page, NOW(), NEW.use_tranz_page);\n  END IF;\n\n  IF OLD.revenue_proc != NEW.revenue_proc THEN\n    INSERT INTO `test_partners_changes`.`g_blocks_changes` (`informer`, `uid_informer`, `who`, `field`, `old_value`, `when`, `new_value`)\n      VALUES (NEW.id, NEW.`uid`, @auth_login, \'revenue_proc\', OLD.revenue_proc, NOW(), NEW.revenue_proc);\n  END IF;\n  IF OLD.contracts_type != NEW.contracts_type THEN\n    INSERT INTO `test_partners_changes`.`g_blocks_changes` (`informer`, `uid_informer`, `who`, `field`, `old_value`, `when`, `new_value`)\n      VALUES (NEW.id, NEW.`uid`, @auth_login, \'contracts_type\', OLD.contracts_type, NOW(), NEW.contracts_type);\n  END IF;\n  IF OLD.client_id != NEW.client_id THEN\n    INSERT INTO `test_partners_changes`.`g_blocks_changes` (`informer`, `uid_informer`, `who`, `field`, `old_value`, `when`, `new_value`)\n      VALUES (NEW.id, NEW.`uid`, @auth_login, \'client_id\', OLD.client_id, NOW(), NEW.client_id);\n  END IF;\n  IF OLD.no_calc_ghits_ctr != NEW.no_calc_ghits_ctr THEN\n    INSERT INTO `test_partners_changes`.`g_blocks_changes` (`informer`, `uid_informer`, `who`, `field`, `old_value`, `when`, `new_value`)\n      VALUES (NEW.id, NEW.`uid`, @auth_login, \'no_calc_ghits_ctr\', OLD.no_calc_ghits_ctr, NOW(), NEW.no_calc_ghits_ctr);\n  END IF;\n  IF OLD.agency_fee_to_wages != NEW.agency_fee_to_wages THEN\n    INSERT INTO `test_partners_changes`.`g_blocks_changes` (`informer`, `uid_informer`, `who`, `field`, `old_value`, `when`, `new_value`)\n      VALUES (NEW.id, NEW.`uid`, @auth_login, \'agency_fee_to_wages\', OLD.agency_fee_to_wages, NOW(), NEW.agency_fee_to_wages);\n  END IF;\n  IF OLD.quality_factor != NEW.quality_factor THEN\n    INSERT INTO `test_partners_changes`.`overall_log`(`table`, `table_id`, `who`, `action`, `old_values`, `new_values`)\n        VALUES (\'g_blocks\', OLD.id, \'cron_antifraud\', \'UPDATE\', OLD.quality_factor, NEW.quality_factor);\n  END IF;\n  IF OLD.category_platform != NEW.category_platform THEN\n    INSERT INTO `test_partners_changes`.`g_blocks_changes` (`informer`, `uid_informer`, `who`, `field`, `old_value`, `when`, `new_value`)\n      VALUES (NEW.id, NEW.`uid`, @auth_login, \'category_platform\', OLD.category_platform, NOW(), NEW.category_platform);\n  END IF;\n  IF OLD.duplicates_count != NEW.duplicates_count THEN\n    INSERT INTO `test_partners_changes`.`g_blocks_changes` (`informer`, `uid_informer`, `who`, `field`, `old_value`, `when`, `new_value`)\n      VALUES (NEW.id, NEW.`uid`, @auth_login, \'duplicates_count\', OLD.duplicates_count, NOW(), NEW.duplicates_count);\n  END IF;\n  IF OLD.rtb_enabled != NEW.rtb_enabled THEN\n    INSERT INTO `test_partners_changes`.`g_blocks_changes` (`informer`, `uid_informer`, `who`, `field`, `old_value`, `when`, `new_value`)\n      VALUES (NEW.id, NEW.`uid`, @auth_login, \'rtb_enabled\', OLD.rtb_enabled, NOW(), NEW.rtb_enabled);\n  END IF;\n  IF OLD.image_format != NEW.image_format THEN\n    INSERT INTO `test_partners_changes`.`g_blocks_changes` (`informer`, `uid_informer`, `who`, `field`, `old_value`, `when`, `new_value`)\n      VALUES (NEW.id, NEW.`uid`, @auth_login, \'image_format\', OLD.image_format, NOW(), NEW.image_format);\n  END IF;\n  IF OLD.ad_types != NEW.ad_types THEN\n    INSERT INTO `test_partners_changes`.`g_blocks_changes` (`informer`, `uid_informer`, `who`, `field`, `old_value`, `when`, `new_value`)\n      VALUES (NEW.id, NEW.`uid`, @auth_login, \'ad_types\', OLD.ad_types, NOW(), NEW.ad_types);\n  END IF;\n  IF OLD.has_sources != NEW.has_sources THEN\n    INSERT INTO `test_partners_changes`.`g_blocks_changes` (`informer`, `uid_informer`, `who`, `field`, `old_value`, `when`, `new_value`)\n      VALUES (NEW.id, NEW.`uid`, @auth_login, \'has_sources\', OLD.has_sources, NOW(), NEW.has_sources);\n  END IF;\n  IF OLD.additional_code1 != NEW.additional_code1 THEN\n    INSERT INTO `test_partners_changes`.`g_blocks_changes` (`informer`, `uid_informer`, `who`, `field`, `old_value`, `when`, `new_value`)\n      VALUES (NEW.id, NEW.`uid`, @auth_login, \'additional_code1\', OLD.additional_code1, NOW(), NEW.additional_code1);\n  END IF;\n  IF OLD.show_cpc != NEW.show_cpc THEN\n    INSERT INTO `test_partners_changes`.`g_blocks_changes` (`informer`, `uid_informer`, `who`, `field`, `old_value`, `when`, `new_value`)\n      VALUES (NEW.id, NEW.`uid`, @auth_login, \'show_cpc\', OLD.show_cpc, NOW(), NEW.show_cpc);\n  END IF;\n  IF OLD.response_algorithm != NEW.response_algorithm THEN\n    INSERT INTO `test_partners_changes`.`g_blocks_changes` (`informer`, `uid_informer`, `who`, `field`, `old_value`, `when`, `new_value`)\n      VALUES (NEW.id, NEW.`uid`, @auth_login, \'response_algorithm\', OLD.response_algorithm, NOW(), NEW.response_algorithm);\n  END IF;\n  IF OLD.disable_cheating_suspicion != NEW.disable_cheating_suspicion THEN\n    INSERT INTO `test_partners_changes`.`g_blocks_changes` (`informer`, `uid_informer`, `who`, `field`, `old_value`, `when`, `new_value`)\n      VALUES (NEW.id, NEW.`uid`, @auth_login, \'disable_cheating_suspicion\', OLD.disable_cheating_suspicion, NOW(), NEW.disable_cheating_suspicion);\n  END IF;\n  IF OLD.show_probability_satellite != NEW.show_probability_satellite THEN\n    INSERT INTO `test_partners_changes`.`g_blocks_changes` (`informer`, `uid_informer`, `who`, `field`, `old_value`, `when`, `new_value`)\n      VALUES (NEW.id, NEW.`uid`, @auth_login, \'show_probability_satellite\', OLD.show_probability_satellite, NOW(), NEW.show_probability_satellite);\n  END IF;\n  IF OLD.response_algorithm != NEW.response_algorithm THEN\n    INSERT INTO `test_partners_changes`.`g_blocks_changes` (`informer`, `uid_informer`, `who`, `field`, `old_value`, `when`, `new_value`)\n      VALUES (NEW.id, NEW.`uid`, @auth_login, \'response_algorithm\', OLD.response_algorithm, NOW(), NEW.response_algorithm);\n  END IF;\nIF OLD.kind != NEW.kind THEN\n    INSERT INTO `test_partners_changes`.`g_blocks_changes` (`informer`, `uid_informer`, `who`, `field`, `old_value`, `when`, `new_value`)\n      VALUES (NEW.id, NEW.`uid`, @auth_login, \'kind\', OLD.kind, NOW(), NEW.kind);\n  END IF;\n  \nEND' 'CREATE DEFINER=`root`@`localhost` TRIGGER `g_blocks_delete_check` BEFORE DELETE ON `g_blocks`\n FOR EACH ROW BEGIN\n\nIF @auth_login IS null THEN\n    INSERT INTO `test_partners_changes`.`null_who_change`(id, `who_change`) VALUES(null, @auth_login);\nEND IF;\n\nIF (LENGTH(@key) > 0) THEN\n    INSERT INTO `test_partners_changes`.`g_blocks_changes`(`informer`, `uid_informer`, `who`, `field`, `old_value`, `when`, `new_value`)\n        VALUES(OLD.id, OLD.`uid`, @auth_login, \'delete\', @key, NOW(), \'\');\nELSE\n    INSERT INTO `test_partners_changes`.`g_blocks_changes`(`invalid_key`) VALUES(\'access_denied\');\nEND IF;\n\nIF @test IS NULL THEN\n    SET @key = \'\';\nEND IF;\n\nEND' 'CREATE DEFINER=`root`@`localhost` TRIGGER `test_partners`.`tr_g_blocks_ad` AFTER DELETE ON `g_blocks`\n FOR EACH ROW BEGIN\n\nINSERT INTO `test_partners_changes`.`informers_del_log`(`id_informer`, `uid_informer`, `name`, `type`, `client_id`, `kind`, `class`, `parent`, `wages_all`, `wages_today`, `wages_all_past`, `when`, `who`) \nVALUES (OLD.`id`, OLD.`uid`, OLD.`name`, \'goods\', OLD.`client_id`, OLD.`kind`, OLD.`class`, OLD.`parent`, OLD.`wages_all`, OLD.`wages_today`, OLD.`wages_all_past`, NOW(), @auth_login); \n\nEND'
sql_modes=1342177280 0 1342177280 1342177280 0 1342177280
definers='root@localhost' 'root@localhost' 'root@localhost' 'root@localhost' 'root@localhost' 'root@localhost'
client_cs_names='utf8' 'utf8' 'utf8' 'utf8' 'utf8' 'utf8'
connection_cl_names='utf8_general_ci' 'utf8_general_ci' 'utf8_general_ci' 'utf8_general_ci' 'utf8_general_ci' 'utf8_general_ci'
db_cl_names='utf8_general_ci' 'utf8_general_ci' 'utf8_general_ci' 'utf8_general_ci' 'utf8_general_ci' 'utf8_general_ci'
created=153375877599 153375877600 153375877601 153375877603 153375877604 153375877606
