TYPE=TRIGGERS
triggers='CREATE DEFINER=`root`@`localhost` TRIGGER test_partners.`tickers_insert_before` BEFORE INSERT ON `tickers`\n FOR EACH ROW BEGIN\n     IF (NEW.subnet = 2) THEN\n\n        IF (NEW.lng_id = 1) THEN\n            SET NEW.mirror = "tovarro";\n        ELSEIF (NEW.lng_id = 7) THEN\n            SET NEW.mirror = "adskeeper";\n        END IF;\n\n    ELSEIF (NEW.mirror = "tovarro") THEN\n        SET NEW.subnet = 2;\n    ELSEIF (NEW.mirror = "adskeeper") THEN\n        SET NEW.subnet = 2;\n    END IF;\n\n	IF NEW.`count_news` > 120 THEN\n		SET NEW.`count_news` = 120;\n	END IF;\n\n	IF NEW.`client_id` = 208468 THEN\n		SET NEW.`nodel` = 1;\n		SET NEW.`no_calc_news_ctr` = 1;\n		SET NEW.`save_list_hosts` = 1;\n	END IF;\n\n	IF NEW.`client_id` = 203751 THEN\n		SET NEW.`nodel` = 1;\n		SET NEW.`no_calc_news_ctr` = 1;\n		SET NEW.`save_list_hosts` = 1;\n	END IF;\n\n	IF NEW.`client_id` = 205875 THEN\n		SET NEW.`nodel` = 1;\n		SET NEW.`no_calc_news_ctr` = 1;\n		SET NEW.`save_list_hosts` = 1;\n	END IF;\n\n	IF NEW.`client_id` = 58188 THEN\n		SET NEW.`nodel` = 1;\n		SET NEW.`no_calc_news_ctr` = 1;\n		SET NEW.`save_list_hosts` = 1;\n	END IF;\n\n	IF NEW.`client_id` = 59124 THEN\n		SET NEW.`nodel` = 1;\n		SET NEW.`no_calc_news_ctr` = 1;\n		SET NEW.`save_list_hosts` = 1;\n	END IF;\n\n        SET NEW.`url_updated` = NOW();\n\n	IF NEW.`tickers_composite_id` IS NOT NULL THEN\n		SET NEW.`class` = \'composite\';\n		SET NEW.`parent` = NEW.`tickers_composite_id`;\n	END IF;\n\n	IF NEW.`tickers_under_id` IS NOT NULL THEN\n		SET NEW.`class` = \'under\';\n		SET NEW.`parent` = NEW.`tickers_under_id`;\n	END IF;\n\n	IF NEW.`class` = \'composite\' AND NEW.`tickers_composite_id` IS NULL THEN\n		SET NEW.`tickers_composite_id` = NEW.`parent`;\n	END IF;\n\n	IF NEW.`class` = \'under\' AND NEW.`tickers_under_id` IS NULL THEN\n		SET NEW.`tickers_under_id` = NEW.`parent`;\n	END IF;\n\n	IF NEW.`tickers_composite_id` IS NOT NULL AND NEW.`tickers_under_id` IS NOT NULL THEN\n		SIGNAL SQLSTATE \'45000\' SET MESSAGE_TEXT = "Widget can\'t have composite id and under id filled simultaneously";\n	END IF;\n\nEND' 'CREATE DEFINER=`root`@`localhost` TRIGGER `tickers_insert_after` AFTER INSERT ON `tickers`\n FOR EACH ROW BEGIN \n\nCALL insert_tickers(NEW.id, NEW.count_news); \n\nEND' 'CREATE DEFINER=`root`@`localhost` TRIGGER `test_partners`.`tr_BU_tickers` BEFORE UPDATE ON `tickers`\nFOR EACH ROW BEGIN\n\n\nIF (OLD.subnet != NEW.subnet) THEN\n    IF (NEW.subnet = 0) THEN\n        SET NEW.mirror = "marketgid";\n    ELSEIF (NEW.subnet = 2) THEN\n        IF (NEW.lng_id = 1) THEN\n            SET NEW.mirror = "tovarro";\n        ELSEIF (NEW.lng_id = 7) THEN\n            SET NEW.mirror = "adskeeper";\n        END IF;\n    END IF;\nELSEIF (OLD.mirror != NEW.mirror) THEN\n    IF (NEW.mirror = "marketgid") THEN\n        SET NEW.subnet = 0;\n    ELSEIF (NEW.mirror = "tovarro") THEN\n        SET NEW.subnet = 2;\n    ELSEIF (NEW.mirror = "adskeeper") THEN\n        SET NEW.subnet = 2;\n    END IF;\nEND IF;\n\n\n\nIF (OLD.rss != NEW.rss) THEN\n	IF (NEW.rss = 1) THEN\n		SET NEW.no_calc_news_ctr = 1;\n	ELSE \n		SET NEW.no_calc_news_ctr = 0;\n    END IF;\nEND IF;\n\nIF OLD.encoding != NEW.encoding THEN\n    SET NEW.`updated_time` = NOW();\nEND IF;\nIF OLD.show_source != NEW.show_source THEN\n    SET NEW.`updated_time` = NOW();\nEND IF;\nIF OLD.show_description != NEW.show_description THEN\n    SET NEW.`updated_time` = NOW();\nEND IF;\nIF OLD.show_photo != NEW.show_photo THEN\n    SET NEW.`updated_time` = NOW();\nEND IF;\nIF OLD.photo_only != NEW.photo_only THEN\n    SET NEW.`updated_time` = NOW();\nEND IF;\nIF OLD.big_photo != NEW.big_photo THEN\n    SET NEW.`updated_time` = NOW();\nEND IF;\nIF OLD.elastic != NEW.elastic THEN\n    SET NEW.`updated_time` = NOW();\nEND IF;\nIF OLD.protocol_version != NEW.protocol_version THEN\n    SET NEW.`updated_time` = NOW();\nEND IF;\nIF OLD.log != NEW.log THEN\n    SET NEW.`updated_time` = NOW();\nEND IF;\nIF OLD.word_filter != NEW.word_filter THEN\n    SET NEW.`updated_time` = NOW();\nEND IF;\nIF OLD.wordnubmer != NEW.wordnubmer THEN\n    SET NEW.`updated_time` = NOW();\nEND IF;\nIF OLD.max_time_news != NEW.max_time_news THEN\n    SET NEW.`updated_time` = NOW();\nEND IF;\nIF OLD.no_calc_news_ctr != NEW.no_calc_news_ctr THEN\n    SET NEW.`updated_time` = NOW();\nEND IF;\nIF OLD.use_nb_mirror != NEW.use_nb_mirror THEN\n    SET NEW.`updated_time` = NOW();\nEND IF;\nIF OLD.debug_info_on != NEW.debug_info_on THEN\n    SET NEW.`updated_time` = NOW();\nEND IF;\nIF NEW.`count_news` > 120 THEN\n    SET NEW.`count_news` = 120;\nEND IF;\nIF OLD.`ignore_referer_check` != NEW.`ignore_referer_check` THEN\n  SET NEW.`url_updated` = NOW();\nEND IF;\nIF OLD.`live_percent` != NEW.`live_percent` THEN\n  SET NEW.`url_updated` = NOW();\nEND IF;\nIF OLD.`id_partner` != NEW.`id_partner` THEN\n  SET NEW.`url_updated` = NOW();\nEND IF;\nIF OLD.`pseudopopunder_enabled` != NEW.`pseudopopunder_enabled` THEN\n  SET NEW.`url_updated` = NOW();\nEND IF;\nIF OLD.`thematic_top_enabled` != NEW.`thematic_top_enabled` THEN\n  SET NEW.`url_updated` = NOW();\nEND IF;\nIF OLD.`split_test_enabled` != NEW.`split_test_enabled` THEN\n  SET NEW.`url_updated` = NOW();\nEND IF;\nIF OLD.`no_show_under` != NEW.`no_show_under` THEN\n  SET NEW.`url_updated` = NOW();\nEND IF;\nIF OLD.`show_popup` != NEW.`show_popup` THEN\n  SET NEW.`url_updated` = NOW();\nEND IF;\nIF OLD.`wrong_clicks_enabled` != NEW.`wrong_clicks_enabled` THEN\n  SET NEW.`url_updated` = NOW();\nEND IF;\nIF OLD.`notransit_mode` != NEW.`notransit_mode` THEN\n  SET NEW.`url_updated` = NOW();\nEND IF;\n\nIF NEW.`tickers_composite_id` IS NOT NULL AND NOT (NEW.`tickers_composite_id` <=> OLD.`tickers_composite_id`) THEN\n  SET NEW.`class` = \'composite\';\n  SET NEW.`parent` = NEW.`tickers_composite_id`;\nEND IF;\n\nIF NEW.`tickers_under_id` IS NOT NULL AND NOT (NEW.`tickers_under_id` <=> OLD.`tickers_under_id`) THEN\n  SET NEW.`class` = \'under\';\n  SET NEW.`parent` = NEW.`tickers_under_id`;\nEND IF;\n\nIF NEW.`class` = \'composite\' AND NOT (NEW.`tickers_composite_id` <=> NEW.`parent`) AND NEW.`parent` <> 0 THEN\n  SET NEW.`tickers_composite_id` = NEW.`parent`;\nEND IF;\n\nIF NEW.`class` = \'under\' AND NOT (NEW.`tickers_under_id` <=> NEW.`parent`) AND NEW.`parent` <> 0 THEN\n  SET NEW.`tickers_under_id` = NEW.`parent`;\nEND IF;\n\nIF NEW.`tickers_composite_id` IS NOT NULL AND NEW.`tickers_under_id` IS NOT NULL THEN\n  SIGNAL SQLSTATE \'45000\' SET MESSAGE_TEXT = "Widget can\'t have composite id and under id filled simultaneously";\nEND IF;\n\nEND' 'CREATE DEFINER=`root`@`localhost` TRIGGER `test_partners`.`tickers_changes`\nAFTER UPDATE\nON `tickers`\nFOR EACH ROW\nBEGIN\n\n  IF OLD.id != NEW.id THEN\n    INSERT INTO `test_partners_changes`.`tickers_changes` (`informer`, `uid_informer`, `who`, `field`, `old_value`, `when`, `new_value`)\n      VALUES (NEW.id, NEW.`uid`, @auth_login, \'id\', OLD.id, NOW(), NEW.id);\n  END IF;\n  IF NOT OLD.name <=> NEW.name THEN\n    INSERT INTO `test_partners_changes`.`tickers_changes` (`informer`, `uid_informer`, `who`, `field`, `old_value`, `when`, `new_value`)\n      VALUES (NEW.id, NEW.`uid`, @auth_login, \'name\', IF(OLD.name IS NULL, \'\', OLD.name), NOW(), IF(NEW.name IS NULL, \'\', NEW.name));\n  END IF;\n  IF NOT OLD.description <=> NEW.description THEN\n    INSERT INTO `test_partners_changes`.`tickers_changes` (`informer`, `uid_informer`, `who`, `field`, `old_value`, `when`, `new_value`)\n      VALUES (NEW.id, NEW.`uid`, @auth_login, \'description\', IF(OLD.description IS NULL, \'\', OLD.description), NOW(), IF(NEW.description IS NULL, \'\', NEW.description));\n  END IF;\n  IF OLD.use_cat != NEW.use_cat THEN\n    INSERT INTO `test_partners_changes`.`tickers_changes` (`informer`, `uid_informer`, `who`, `field`, `old_value`, `when`, `new_value`)\n      VALUES (NEW.id, NEW.`uid`, @auth_login, \'use_cat\', OLD.use_cat, NOW(), NEW.use_cat);\n  END IF;\n  IF OLD.count_news != NEW.count_news THEN\n    INSERT INTO `test_partners_changes`.`tickers_changes` (`informer`, `uid_informer`, `who`, `field`, `old_value`, `when`, `new_value`)\n      VALUES (NEW.id, NEW.`uid`, @auth_login, \'count_news\', OLD.count_news, NOW(), NEW.count_news);\n    CALL pr_tickers_count_news(NEW.id, OLD.count_news, NEW.count_news);\n  END IF;\n  IF OLD.encoding != NEW.encoding THEN\n    INSERT INTO `test_partners_changes`.`tickers_changes` (`informer`, `uid_informer`, `who`, `field`, `old_value`, `when`, `new_value`)\n      VALUES (NEW.id, NEW.`uid`, @auth_login, \'encoding\', OLD.encoding, NOW(), NEW.encoding);\n  END IF;\n  IF OLD.filter_2 != NEW.filter_2 THEN\n    INSERT INTO `test_partners_changes`.`tickers_changes` (`informer`, `uid_informer`, `who`, `field`, `old_value`, `when`, `new_value`)\n      VALUES (NEW.id, NEW.`uid`, @auth_login, \'filter_2\', OLD.filter_2, NOW(), NEW.filter_2);\n  END IF;\n  IF OLD.show_source != NEW.show_source THEN\n    INSERT INTO `test_partners_changes`.`tickers_changes` (`informer`, `uid_informer`, `who`, `field`, `old_value`, `when`, `new_value`)\n      VALUES (NEW.id, NEW.`uid`, @auth_login, \'show_source\', OLD.show_source, NOW(), NEW.show_source);\n  END IF;\n  IF OLD.show_description != NEW.show_description THEN\n    INSERT INTO `test_partners_changes`.`tickers_changes` (`informer`, `uid_informer`, `who`, `field`, `old_value`, `when`, `new_value`)\n      VALUES (NEW.id, NEW.`uid`, @auth_login, \'show_description\', OLD.show_description, NOW(), NEW.show_description);\n  END IF;\n  IF OLD.show_photo != NEW.show_photo THEN\n    INSERT INTO `test_partners_changes`.`tickers_changes` (`informer`, `uid_informer`, `who`, `field`, `old_value`, `when`, `new_value`)\n      VALUES (NEW.id, NEW.`uid`, @auth_login, \'show_photo\', OLD.show_photo, NOW(), NEW.show_photo);\n  END IF;\n  IF OLD.photo_only != NEW.photo_only THEN\n    INSERT INTO `test_partners_changes`.`tickers_changes` (`informer`, `uid_informer`, `who`, `field`, `old_value`, `when`, `new_value`)\n      VALUES (NEW.id, NEW.`uid`, @auth_login, \'photo_only\', OLD.photo_only, NOW(), NEW.photo_only);\n  END IF;\n  IF NOT OLD.code_js <=> NEW.code_js THEN\n    INSERT INTO `test_partners_changes`.`tickers_changes` (`informer`, `uid_informer`, `who`, `field`, `old_value`, `when`, `new_value`)\n      VALUES (NEW.id, NEW.`uid`, @auth_login, \'code_js\', IF(OLD.code_js IS NULL, \'\', OLD.code_js), NOW(), IF(NEW.code_js IS NULL, \'\', NEW.code_js));\n  END IF;\n  IF OLD.creator != NEW.creator THEN\n    INSERT INTO `test_partners_changes`.`tickers_changes` (`informer`, `uid_informer`, `who`, `field`, `old_value`, `when`, `new_value`)\n      VALUES (NEW.id, NEW.`uid`, @auth_login, \'creator\', OLD.creator, NOW(), NEW.creator);\n  END IF;\n  IF OLD.editor != NEW.editor THEN\n    INSERT INTO `test_partners_changes`.`tickers_changes` (`informer`, `uid_informer`, `who`, `field`, `old_value`, `when`, `new_value`)\n      VALUES (NEW.id, NEW.`uid`, @auth_login, \'editor\', OLD.editor, NOW(), NEW.editor);\n  END IF;\n  IF OLD.big_photo != NEW.big_photo THEN\n    INSERT INTO `test_partners_changes`.`tickers_changes` (`informer`, `uid_informer`, `who`, `field`, `old_value`, `when`, `new_value`)\n      VALUES (NEW.id, NEW.`uid`, @auth_login, \'big_photo\', OLD.big_photo, NOW(), NEW.big_photo);\n  END IF;\n  IF OLD.animation != NEW.animation THEN\n    INSERT INTO `test_partners_changes`.`tickers_changes` (`informer`, `uid_informer`, `who`, `field`, `old_value`, `when`, `new_value`)\n      VALUES (NEW.id, NEW.`uid`, @auth_login, \'animation\', OLD.animation, NOW(), NEW.animation);\n  END IF;\n  IF OLD.popunder != NEW.popunder THEN\n    INSERT INTO `test_partners_changes`.`tickers_changes` (`informer`, `uid_informer`, `who`, `field`, `old_value`, `when`, `new_value`)\n      VALUES (NEW.id, NEW.`uid`, @auth_login, \'popunder\', OLD.popunder, NOW(), NEW.popunder);\n  END IF;\n  IF OLD.rss != NEW.rss THEN\n    INSERT INTO `test_partners_changes`.`tickers_changes` (`informer`, `uid_informer`, `who`, `field`, `old_value`, `when`, `new_value`)\n      VALUES (NEW.id, NEW.`uid`, @auth_login, \'rss\', OLD.rss, NOW(), NEW.rss);\n  END IF;\n  IF OLD.check_net_c != NEW.check_net_c THEN\n    INSERT INTO `test_partners_changes`.`tickers_changes` (`informer`, `uid_informer`, `who`, `field`, `old_value`, `when`, `new_value`)\n      VALUES (NEW.id, NEW.`uid`, @auth_login, \'check_net_c\', OLD.check_net_c, NOW(), NEW.check_net_c);\n  END IF;\n  IF OLD.status != NEW.status THEN\n    INSERT INTO `test_partners_changes`.`tickers_changes` (`informer`, `uid_informer`, `who`, `field`, `old_value`, `when`, `new_value`)\n      VALUES (NEW.id, NEW.`uid`, @auth_login, \'status\', OLD.status, NOW(), NEW.status);\n  END IF;\n  IF OLD.img_type != NEW.img_type THEN\n    INSERT INTO `test_partners_changes`.`tickers_changes` (`informer`, `uid_informer`, `who`, `field`, `old_value`, `when`, `new_value`)\n      VALUES (NEW.id, NEW.`uid`, @auth_login, \'img_type\', OLD.img_type, NOW(), NEW.img_type);\n  END IF;\n  IF OLD.title_limit != NEW.title_limit THEN\n    INSERT INTO `test_partners_changes`.`tickers_changes` (`informer`, `uid_informer`, `who`, `field`, `old_value`, `when`, `new_value`)\n      VALUES (NEW.id, NEW.`uid`, @auth_login, \'title_limit\', OLD.title_limit, NOW(), NEW.title_limit);\n  END IF;\n  IF OLD.title_break != NEW.title_break THEN\n    INSERT INTO `test_partners_changes`.`tickers_changes` (`informer`, `uid_informer`, `who`, `field`, `old_value`, `when`, `new_value`)\n      VALUES (NEW.id, NEW.`uid`, @auth_login, \'title_break\', OLD.title_break, NOW(), NEW.title_break);\n  END IF;\n  IF OLD.desc_limit != NEW.desc_limit THEN\n    INSERT INTO `test_partners_changes`.`tickers_changes` (`informer`, `uid_informer`, `who`, `field`, `old_value`, `when`, `new_value`)\n      VALUES (NEW.id, NEW.`uid`, @auth_login, \'desc_limit\', OLD.desc_limit, NOW(), NEW.desc_limit);\n  END IF;\n  IF OLD.desc_break != NEW.desc_break THEN\n    INSERT INTO `test_partners_changes`.`tickers_changes` (`informer`, `uid_informer`, `who`, `field`, `old_value`, `when`, `new_value`)\n      VALUES (NEW.id, NEW.`uid`, @auth_login, \'desc_break\', OLD.desc_break, NOW(), NEW.desc_break);\n  END IF;\n  IF OLD.pmc_page != NEW.pmc_page THEN\n    INSERT INTO `test_partners_changes`.`tickers_changes` (`informer`, `uid_informer`, `who`, `field`, `old_value`, `when`, `new_value`)\n      VALUES (NEW.id, NEW.`uid`, @auth_login, \'pmc_page\', OLD.pmc_page, NOW(), NEW.pmc_page);\n  END IF;\n  IF OLD.manager != NEW.manager THEN\n    INSERT INTO `test_partners_changes`.`tickers_changes` (`informer`, `uid_informer`, `who`, `field`, `old_value`, `when`, `new_value`)\n      VALUES (NEW.id, NEW.`uid`, @auth_login, \'manager\', OLD.manager, NOW(), NEW.manager);\n  END IF;\n  IF OLD.class != NEW.class THEN\n    INSERT INTO `test_partners_changes`.`tickers_changes` (`informer`, `uid_informer`, `who`, `field`, `old_value`, `when`, `new_value`)\n      VALUES (NEW.id, NEW.`uid`, @auth_login, \'class\', OLD.class, NOW(), NEW.class);\n  END IF;\n  IF OLD.parent != NEW.parent THEN\n    INSERT INTO `test_partners_changes`.`tickers_changes` (`informer`, `uid_informer`, `who`, `field`, `old_value`, `when`, `new_value`)\n      VALUES (NEW.id, NEW.`uid`, @auth_login, \'parent\', OLD.parent, NOW(), NEW.parent);\n  END IF;\n  IF OLD.elastic != NEW.elastic THEN\n    INSERT INTO `test_partners_changes`.`tickers_changes` (`informer`, `uid_informer`, `who`, `field`, `old_value`, `when`, `new_value`)\n      VALUES (NEW.id, NEW.`uid`, @auth_login, \'elastic\', OLD.elastic, NOW(), NEW.elastic);\n  END IF;\n  IF OLD.id_partner != NEW.id_partner THEN\n    INSERT INTO `test_partners_changes`.`tickers_changes` (`informer`, `uid_informer`, `who`, `field`, `old_value`, `when`, `new_value`)\n      VALUES (NEW.id, NEW.`uid`, @auth_login, \'id_partner\', OLD.id_partner, NOW(), NEW.id_partner);\n  END IF;\n  IF OLD.enabled != NEW.enabled THEN\n    INSERT INTO `test_partners_changes`.`tickers_changes` (`informer`, `uid_informer`, `who`, `field`, `old_value`, `when`, `new_value`)\n      VALUES (NEW.id, NEW.`uid`, @auth_login, \'enabled\', OLD.enabled, NOW(), NEW.enabled);\n  END IF;\n  IF OLD.without_green_news != NEW.without_green_news THEN\n    INSERT INTO `test_partners_changes`.`tickers_changes` (`informer`, `uid_informer`, `who`, `field`, `old_value`, `when`, `new_value`)\n      VALUES (NEW.id, NEW.`uid`, @auth_login, \'without_green_news\', OLD.without_green_news, NOW(), NEW.without_green_news);\n  END IF;\n  IF OLD.wrong_clicks_enabled != NEW.wrong_clicks_enabled THEN\n    INSERT INTO `test_partners_changes`.`tickers_changes` (`informer`, `uid_informer`, `who`, `field`, `old_value`, `when`, `new_value`)\n      VALUES (NEW.id, NEW.`uid`, @auth_login, \'wrong_clicks_enabled\', OLD.wrong_clicks_enabled, NOW(), NEW.wrong_clicks_enabled);\n  END IF;\n  IF OLD.revenue_proc != NEW.revenue_proc THEN\n    INSERT INTO `test_partners_changes`.`tickers_changes` (`informer`, `uid_informer`, `who`, `field`, `old_value`, `when`, `new_value`)\n      VALUES (NEW.id, NEW.`uid`, @auth_login, \'revenue_proc\', OLD.revenue_proc, NOW(), NEW.revenue_proc);\n  END IF;\n  IF OLD.max_time_news != NEW.max_time_news THEN\n    INSERT INTO `test_partners_changes`.`tickers_changes` (`informer`, `uid_informer`, `who`, `field`, `old_value`, `when`, `new_value`)\n      VALUES (NEW.id, NEW.`uid`, @auth_login, \'max_time_news\', OLD.max_time_news, NOW(), NEW.max_time_news);\n  END IF;\n  IF OLD.notransit_mode != NEW.notransit_mode THEN\n    INSERT INTO `test_partners_changes`.`tickers_changes` (`informer`, `uid_informer`, `who`, `field`, `old_value`, `when`, `new_value`)\n      VALUES (NEW.id, NEW.`uid`, @auth_login, \'notransit_mode\', OLD.notransit_mode, NOW(), NEW.notransit_mode);\n  END IF;\n  IF OLD.contracts_type != NEW.contracts_type THEN\n    INSERT INTO `test_partners_changes`.`tickers_changes` (`informer`, `uid_informer`, `who`, `field`, `old_value`, `when`, `new_value`)\n      VALUES (NEW.id, NEW.`uid`, @auth_login, \'contracts_type\', OLD.contracts_type, NOW(), NEW.contracts_type);\n  END IF;\n  IF OLD.client_id != NEW.client_id THEN\n    INSERT INTO `test_partners_changes`.`tickers_changes` (`informer`, `uid_informer`, `who`, `field`, `old_value`, `when`, `new_value`)\n      VALUES (NEW.id, NEW.`uid`, @auth_login, \'client_id\', OLD.client_id, NOW(), NEW.client_id);\n  END IF;\n  IF OLD.subnet != NEW.subnet THEN\n    INSERT INTO `test_partners_changes`.`tickers_changes` (`informer`, `uid_informer`, `who`, `field`, `old_value`, `when`, `new_value`)\n      VALUES (NEW.id, NEW.`uid`, @auth_login, \'subnet\', OLD.subnet, NOW(), NEW.subnet);\n  END IF;\n  IF OLD.show_dark_news != NEW.show_dark_news THEN\n    INSERT INTO `test_partners_changes`.`tickers_changes` (`informer`, `uid_informer`, `who`, `field`, `old_value`, `when`, `new_value`)\n      VALUES (NEW.id, NEW.`uid`, @auth_login, \'show_dark_news\', OLD.show_dark_news, NOW(), NEW.show_dark_news);\n  END IF;\n  IF OLD.ac_stats_enabled != NEW.ac_stats_enabled THEN\n    INSERT INTO `test_partners_changes`.`tickers_changes` (`informer`, `uid_informer`, `who`, `field`, `old_value`, `when`, `new_value`)\n      VALUES (NEW.id, NEW.`uid`, @auth_login, \'ac_stats_enabled\', OLD.ac_stats_enabled, NOW(), NEW.ac_stats_enabled);\n  END IF;\n\n  IF OLD.image_format != NEW.image_format THEN\n    INSERT INTO `test_partners_changes`.`tickers_changes` (`informer`, `uid_informer`, `who`, `field`, `old_value`, `when`, `new_value`)\n      VALUES (NEW.id, NEW.`uid`, @auth_login, \'image_format\', OLD.image_format, NOW(), NEW.image_format);\n  END IF;\n  IF OLD.only_paying != NEW.only_paying THEN\n    INSERT INTO `test_partners_changes`.`tickers_changes` (`informer`, `uid_informer`, `who`, `field`, `old_value`, `when`, `new_value`)\n      VALUES (NEW.id, NEW.`uid`, @auth_login, \'only_paying\', OLD.only_paying, NOW(), NEW.only_paying);\n  END IF;\n  IF OLD.ad_types != NEW.ad_types THEN\n    INSERT INTO `test_partners_changes`.`tickers_changes` (`informer`, `uid_informer`, `who`, `field`, `old_value`, `when`, `new_value`)\n      VALUES (NEW.id, NEW.`uid`, @auth_login, \'ad_types\', OLD.ad_types, NOW(), NEW.ad_types);\n  END IF;\n  IF OLD.has_sources != NEW.has_sources THEN\n    INSERT INTO `test_partners_changes`.`tickers_changes` (`informer`, `uid_informer`, `who`, `field`, `old_value`, `when`, `new_value`)\n      VALUES (NEW.id, NEW.`uid`, @auth_login, \'has_sources\', OLD.has_sources, NOW(), NEW.has_sources);\n    IF NEW.class = \'composite\' THEN\n  		UPDATE `test_partners`.`tickers_composite` SET enable_source = NEW.has_sources WHERE id = NEW.parent;\n  	END IF;\n  END IF;\n  IF OLD.comscore_enable != NEW.comscore_enable THEN\n    INSERT INTO `test_partners_changes`.`tickers_changes` (`informer`, `uid_informer`, `who`, `field`, `old_value`, `when`, `new_value`)\n      VALUES (NEW.id, NEW.`uid`, @auth_login, \'comscore_enable\', OLD.comscore_enable, NOW(), NEW.comscore_enable);\n  END IF;\n  IF OLD.kind != NEW.kind THEN\n    INSERT INTO `test_partners_changes`.`tickers_changes` (`informer`, `uid_informer`, `who`, `field`, `old_value`, `when`, `new_value`)\n      VALUES (NEW.id, NEW.`uid`, @auth_login, \'kind\', OLD.kind, NOW(), NEW.kind);\n  END IF;\nEND' 'CREATE DEFINER=`root`@`localhost` TRIGGER `tickers_delete_check` BEFORE DELETE ON `tickers`\n FOR EACH ROW BEGIN\n\nIF @auth_login IS null THEN\n    INSERT INTO `test_partners_changes`.`null_who_change`(id, `who_change`) VALUES(null, @auth_login);\nEND IF;\n\n\n\nINSERT INTO `test_partners_changes`.`tickers_changes`(`informer`, `uid_informer`, `who`, `field`, `old_value`, `when`, `new_value`)\n    VALUES(OLD.id, OLD.`uid`, @auth_login, \'delete\', @auth_login, NOW(), \'\');\n\nIF @test IS NULL THEN\n    SET @key = \'\';\nEND IF;\n\nEND' 'CREATE DEFINER=`root`@`localhost` TRIGGER `test_partners`.`tr_tickers_ad` AFTER DELETE ON `tickers`\n FOR EACH ROW BEGIN\n\nINSERT INTO `test_partners_changes`.`informers_del_log`(`id_informer`, `uid_informer`, `name`, `type`, `client_id`, `kind`, `class`, `parent`, `wages_all`, `wages_today`, `wages_all_past`, `when`, `who`) \nVALUES (OLD.`id`, OLD.`uid`, OLD.`name`, \'news\', OLD.`client_id`, OLD.`kind`, OLD.`class`, OLD.`parent`, OLD.`wages_all`, OLD.`wages_today`, OLD.`wages_all_past`, NOW(), @auth_login); \n\nEND'
sql_modes=1342177280 0 1342177280 1342177280 1342177280 1342177280
definers='root@localhost' 'root@localhost' 'root@localhost' 'root@localhost' 'root@localhost' 'root@localhost'
client_cs_names='utf8' 'utf8' 'utf8' 'utf8' 'utf8' 'utf8'
connection_cl_names='utf8_general_ci' 'utf8_general_ci' 'utf8_general_ci' 'utf8_general_ci' 'utf8_general_ci' 'utf8_general_ci'
db_cl_names='utf8_general_ci' 'utf8_general_ci' 'utf8_general_ci' 'utf8_general_ci' 'utf8_general_ci' 'utf8_general_ci'
created=153375877667 153375877668 153375877669 153375877670 153375877672 153375877673
