TYPE=TRIGGERS
triggers='CREATE DEFINER=`root`@`localhost` TRIGGER `test_partners`.`tr_tickers_composite_bi`\nBEFORE INSERT\nON `tickers_composite`\nFOR EACH ROW\nBEGIN\n\n	IF NEW.`category_platform` = 103 AND NEW.lng_id = 7 THEN\n		SET NEW.`counters_disabled` = 1;\n	END IF;\n\nEND' 'CREATE DEFINER=`root`@`localhost` TRIGGER `test_partners`.`tr_tickers_composite_bu`\nBEFORE UPDATE\nON `tickers_composite`\nFOR EACH ROW\nBEGIN\n\n	IF NEW.`category_platform` = 103 AND NEW.lng_id = 7 THEN\n		SET NEW.`counters_disabled` = 1;\n	END IF;\n\nEND' 'CREATE DEFINER=`root`@`localhost` TRIGGER `tr_tickers_composite_au` AFTER UPDATE ON `tickers_composite` FOR EACH ROW BEGIN\n\n  IF OLD.show_dark_news != NEW.show_dark_news THEN\n    INSERT INTO `test_partners_changes`.`tickers_composite_changes` (`informer`, `who`, `field`, `old_value`, `when`, `new_value`)\n      VALUES (NEW.id, @auth_login, \'show_dark_news\', OLD.show_dark_news, NOW(), NEW.show_dark_news);\n  END IF;\n  IF OLD.autorefresh != NEW.autorefresh THEN\n    INSERT INTO `test_partners_changes`.`tickers_composite_changes` (`informer`, `who`, `field`, `old_value`, `when`, `new_value`)\n      VALUES (NEW.id, @auth_login, \'autorefresh\', OLD.autorefresh, NOW(), NEW.autorefresh);\n  END IF;\n  IF OLD.random_clicks_disabled != NEW.random_clicks_disabled THEN\n    INSERT INTO `test_partners_changes`.`tickers_composite_changes` (`informer`, `who`, `field`, `old_value`, `when`, `new_value`)\n    VALUES (NEW.id, @auth_login, \'random_clicks_disabled\', OLD.random_clicks_disabled, NOW(), NEW.random_clicks_disabled);\n  END IF;\n  IF OLD.random_clicks_disabled_desktop != NEW.random_clicks_disabled_desktop THEN\n    INSERT INTO `test_partners_changes`.`tickers_composite_changes` (`informer`, `who`, `field`, `old_value`, `when`, `new_value`)\n    VALUES (NEW.id, @auth_login, \'random_clicks_disabled_desktop\', OLD.random_clicks_disabled_desktop, NOW(), NEW.random_clicks_disabled_desktop);\n  END IF;\n  IF OLD.mobile_doubleclick_delay != NEW.mobile_doubleclick_delay THEN\n    INSERT INTO `test_partners_changes`.`tickers_composite_changes` (`informer`, `who`, `field`, `old_value`, `when`, `new_value`)\n    VALUES (NEW.id, @auth_login, \'mobile_doubleclick_delay\', OLD.mobile_doubleclick_delay, NOW(), NEW.mobile_doubleclick_delay);\n  END IF;\n  IF OLD.mobile_doubleclick_button_delay != NEW.mobile_doubleclick_button_delay THEN\n    INSERT INTO `test_partners_changes`.`tickers_composite_changes` (`informer`, `who`, `field`, `old_value`, `when`, `new_value`)\n    VALUES (NEW.id, @auth_login, \'mobile_doubleclick_button_delay\', OLD.mobile_doubleclick_button_delay, NOW(), NEW.mobile_doubleclick_button_delay);\n  END IF;\n  IF OLD.desktop_doubleclick_delay != NEW.desktop_doubleclick_delay THEN\n    INSERT INTO `test_partners_changes`.`tickers_composite_changes` (`informer`, `who`, `field`, `old_value`, `when`, `new_value`)\n    VALUES (NEW.id, @auth_login, \'desktop_doubleclick_delay\', OLD.desktop_doubleclick_delay, NOW(), NEW.desktop_doubleclick_delay);\n  END IF;\n  IF OLD.activate_delay != NEW.activate_delay THEN\n    INSERT INTO `test_partners_changes`.`tickers_composite_changes` (`informer`, `who`, `field`, `old_value`, `when`, `new_value`)\n    VALUES (NEW.id, @auth_login, \'activate_delay\', OLD.activate_delay, NOW(), NEW.activate_delay);\n  END IF;\n  IF OLD.suspicious != NEW.suspicious THEN\n    INSERT INTO `test_partners_changes`.`tickers_composite_changes` (`informer`, `who`, `field`, `old_value`, `when`, `new_value`)\n    VALUES (NEW.id, @auth_login, \'suspicious\', OLD.suspicious, NOW(), NEW.suspicious);\n  END IF;\n  IF OLD.enable_source != NEW.enable_source THEN\n    INSERT INTO `test_partners_changes`.`tickers_composite_changes` (`informer`, `who`, `field`, `old_value`, `when`, `new_value`)\n      VALUES (NEW.id, @auth_login, \'enable_source\', OLD.enable_source, NOW(), NEW.enable_source);\n  END IF;\n  IF NOT OLD.source_name <=> NEW.source_name THEN\n    INSERT INTO `test_partners_changes`.`tickers_composite_changes` (`informer`, `who`, `field`, `old_value`, `when`, `new_value`)\n      VALUES (NEW.id, @auth_login, \'source_name\', OLD.source_name, NOW(), NEW.source_name);\n  END IF;\n  IF OLD.enabled != NEW.enabled THEN\n    UPDATE `test_partners`.`g_blocks` SET enabled = NEW.enabled WHERE tickers_composite_id = NEW.id;\n    UPDATE `test_partners`.`tickers`  SET enabled = NEW.enabled WHERE tickers_composite_id = NEW.id;\n  END IF;\n  IF OLD.mirror != NEW.mirror THEN\n    INSERT INTO `test_partners_changes`.`tickers_composite_changes` (`informer`, `who`, `field`, `old_value`, `when`, `new_value`)\n      VALUES (NEW.id, @auth_login, \'mirror\', OLD.mirror, NOW(), NEW.mirror);\n  END IF;\n  IF OLD.droped = 0 AND NEW.droped = 1 THEN\n    DELETE FROM tickers_composite_placement_configuration WHERE tickers_composite_id = NEW.id;\n  END IF;\n\n  IF NOT OLD.contracts_type <=> NEW.contracts_type THEN\n    INSERT INTO `test_partners_changes`.`tickers_composite_changes` (`informer`, `who`, `field`, `old_value`, `when`, `new_value`)\n      VALUES (NEW.id, @auth_login, \'contracts_type\', OLD.contracts_type, NOW(), NEW.contracts_type);\n  END IF;\n  IF NOT OLD.price <=> NEW.price THEN\n    INSERT INTO `test_partners_changes`.`tickers_composite_changes` (`informer`, `who`, `field`, `old_value`, `when`, `new_value`)\n      VALUES (NEW.id, @auth_login, \'price\', OLD.price, NOW(), NEW.price);\n  END IF;\n  IF NOT OLD.revenue_proc <=> NEW.revenue_proc THEN\n    INSERT INTO `test_partners_changes`.`tickers_composite_changes` (`informer`, `who`, `field`, `old_value`, `when`, `new_value`)\n      VALUES (NEW.id, @auth_login, \'revenue_proc\', OLD.revenue_proc, NOW(), NEW.revenue_proc);\n  END IF;\n  IF NOT OLD.contracts_end_date <=> NEW.contracts_end_date THEN\n    INSERT INTO `test_partners_changes`.`tickers_composite_changes` (`informer`, `who`, `field`, `old_value`, `when`, `new_value`)\n      VALUES (NEW.id, @auth_login, \'contracts_end_date\', OLD.contracts_end_date, NOW(), NEW.contracts_end_date);\n  END IF;\n\nEND'
sql_modes=1342177280 1342177280 1342177280
definers='root@localhost' 'root@localhost' 'root@localhost'
client_cs_names='utf8' 'utf8' 'utf8mb4'
connection_cl_names='utf8_general_ci' 'utf8_general_ci' 'utf8mb4_unicode_ci'
db_cl_names='utf8_general_ci' 'utf8_general_ci' 'utf8_general_ci'
created=153375877675 153375877676 153375877677
