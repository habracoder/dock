TYPE=TRIGGERS
triggers='CREATE DEFINER=`root`@`localhost` TRIGGER `tickers_under_changes_before` BEFORE UPDATE ON `tickers_under`\nFOR EACH ROW BEGIN\n\nIF @auth_login IS null AND (\nOLD.lng_id != NEW.lng_id\nOR OLD.name != NEW.name\nOR OLD.description != NEW.description\nOR OLD.creator != NEW.creator\nOR OLD.editor != NEW.editor\nOR OLD.id_partner != NEW.id_partner\nOR OLD.tasks != NEW.tasks\nOR OLD.status != NEW.status\nOR OLD.manager != NEW.manager\nOR OLD.class != NEW.class\nOR OLD.url != NEW.url\nOR OLD.time_pop != NEW.time_pop\n) THEN\n   INSERT INTO `test_partners_changes`.`null_who_change`(id, `who_change`) VALUES(null, @auth_login);\nEND IF;\nEND' 'CREATE DEFINER=`root`@`localhost` TRIGGER `tickers_under_changes` AFTER UPDATE ON `tickers_under` FOR EACH ROW BEGIN\n\nIF OLD.lng_id != NEW.lng_id THEN\n    INSERT INTO `test_partners_changes`.`tickers_under_changes`(`informer`, `who`, `field`, `old_value`, `when`, `new_value`)\n        VALUES(NEW.id, @auth_login, \'lng_id\', OLD.lng_id, NOW(), NEW.lng_id);\nEND IF;\n\nIF OLD.name != NEW.name THEN\n    INSERT INTO `test_partners_changes`.`tickers_under_changes`(`informer`, `who`, `field`, `old_value`, `when`, `new_value`)\n        VALUES(NEW.id, @auth_login, \'name\', OLD.name, NOW(), NEW.name);\nEND IF;\n\nIF OLD.description != NEW.description THEN\n    INSERT INTO `test_partners_changes`.`tickers_under_changes`(`informer`, `who`, `field`, `old_value`, `when`, `new_value`)\n        VALUES(NEW.id, @auth_login, \'description\', OLD.description, NOW(), NEW.description);\nEND IF;\n\nIF OLD.creator != NEW.creator THEN\n    INSERT INTO `test_partners_changes`.`tickers_under_changes`(`informer`, `who`, `field`, `old_value`, `when`, `new_value`)\n        VALUES(NEW.id, @auth_login, \'creator\', OLD.creator, NOW(), NEW.creator);\nEND IF;\n\nIF OLD.editor != NEW.editor THEN\n    INSERT INTO `test_partners_changes`.`tickers_under_changes`(`informer`, `who`, `field`, `old_value`, `when`, `new_value`)\n        VALUES(NEW.id, @auth_login, \'editor\', OLD.editor, NOW(), NEW.editor);\nEND IF;\n\nIF OLD.id_partner != NEW.id_partner THEN\n    INSERT INTO `test_partners_changes`.`tickers_under_changes`(`informer`, `who`, `field`, `old_value`, `when`, `new_value`)\n        VALUES(NEW.id, @auth_login, \'id_partner\', OLD.id_partner, NOW(), NEW.id_partner);\nEND IF;\n\nIF OLD.tasks != NEW.tasks THEN\n    INSERT INTO `test_partners_changes`.`tickers_under_changes`(`informer`, `who`, `field`, `old_value`, `when`, `new_value`)\n        VALUES(NEW.id, @auth_login, \'tasks\', OLD.tasks, NOW(), NEW.tasks);\nEND IF;\n\nIF OLD.status != NEW.status THEN\n    INSERT INTO `test_partners_changes`.`tickers_under_changes`(`informer`, `who`, `field`, `old_value`, `when`, `new_value`)\n        VALUES(NEW.id, @auth_login, \'status\', OLD.status, NOW(), NEW.status);\nEND IF;\n\nIF OLD.manager != NEW.manager THEN\n    INSERT INTO `test_partners_changes`.`tickers_under_changes`(`informer`, `who`, `field`, `old_value`, `when`, `new_value`)\n        VALUES(NEW.id, @auth_login, \'manager\', OLD.manager, NOW(), NEW.manager);\nEND IF;\n\nIF OLD.class != NEW.class THEN\n    INSERT INTO `test_partners_changes`.`tickers_under_changes`(`informer`, `who`, `field`, `old_value`, `when`, `new_value`)\n        VALUES(NEW.id, @auth_login, \'class\', OLD.class, NOW(), NEW.class);\nEND IF;\n\nIF OLD.url != NEW.url THEN\n    INSERT INTO `test_partners_changes`.`tickers_under_changes`(`informer`, `who`, `field`, `old_value`, `when`, `new_value`)\n        VALUES(NEW.id, @auth_login, \'url\', OLD.url, NOW(), NEW.url);\nEND IF;\n\nIF OLD.time_pop != NEW.time_pop THEN\n    INSERT INTO `test_partners_changes`.`tickers_under_changes`(`informer`, `who`, `field`, `old_value`, `when`, `new_value`)\n        VALUES(NEW.id, @auth_login, \'time_pop\', OLD.time_pop, NOW(), NEW.time_pop);\nEND IF;\n\n\n\nEND' 'CREATE DEFINER=`root`@`localhost` TRIGGER `tickers_under_delete_check` BEFORE DELETE ON `tickers_under`\n FOR EACH ROW BEGIN\n\nIF @auth_login IS null THEN\n    INSERT INTO `test_partners_changes`.`null_who_change`(id, `who_change`) VALUES(null, @auth_login);\nEND IF;\n\nIF (LENGTH(@key) > 0) THEN\n    INSERT INTO `test_partners_changes`.`tickers_under_changes`(`informer`, `who`, `field`, `old_value`, `when`, \n\n`new_value`)\n        VALUES(OLD.id, @auth_login, \'delete\', @key, NOW(), \'\');\nELSE\n    INSERT INTO `test_partners_changes`.`tickers_under_changes`(`invalid_key`) VALUES(\'access_denied\');\nEND IF;\n\nIF @test IS NULL THEN\n    SET @key = \'\';\nEND IF;\n\nEND'
sql_modes=0 0 0
definers='root@localhost' 'root@localhost' 'root@localhost'
client_cs_names='utf8' 'utf8' 'utf8'
connection_cl_names='utf8_general_ci' 'utf8_general_ci' 'utf8_general_ci'
db_cl_names='utf8_general_ci' 'utf8_general_ci' 'utf8_general_ci'
created=153375877679 153375877680 153375877681
